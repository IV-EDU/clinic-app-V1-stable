from __future__ import annotations
from typing import Dict

from flask import current_app, has_request_context, request

SUPPORTED_LOCALES = ("en", "ar")
FALLBACK_LOCALE = "en"

I18N: Dict[str, Dict[str, str]] = {
    "en": {
        "app_title": "Clinic App",
        "home": "Home",
        "add_patient": "+ Patient",
        "export_patients": "Export Patients (CSV)",
        "export_payments": "Export Payments (CSV)",
        "backup": "Backup DB (ZIP)",
        "login": "Login",
        "logout": "Logout",
        "lang_en": "English",
        "lang_ar": "العربية",
        "search_placeholder": "Search name, phone, file or page",
        "search": "Search",
        "matched": "Matched",
        "clear": "Clear",
        "sort_oldest_first": "Oldest first",
        "sort_newest_first": "Newest first",
        "patients": "Patients",
        "total_received": "Today’s Collected",
        "no_patients": "No patients yet. Add one.",
        "file_no": "File Number",
        "file_no_hint": "Leave empty to auto-generate (e.g. P000123).",
        "file_no_exists": "File Number already exists. Choose another.",
        "dup_patient_name": "A patient with this name already exists.",
        "dup_patient_name_allowed": "Duplicate name detected. Saved anyway.",
        "auto_short_id": "Provided file number exists. Auto-generated a new one.",
        "name": "Name",
        "phone": "Phone",
        "phone_numbers": "Phone numbers",
        "phone_label": "Label",
        "primary_phone": "Primary phone",
        "additional_phones": "Additional phone numbers",
        "add_phone": "Add phone",
        "remove": "Remove",
        "notes": "Notes",
        "cancel": "Cancel",
        "save": "Save",
        "update": "Update",
        "new_patient": "New Patient",
        "open": "Open",
        "edit_patient": "Edit Patient",
        "payments": "Payments",
        "treatments": "Treatments",
        "diagnosis": "Diagnosis",
        "date": "Date",
        "method": "Method",
        "amount": "Paid Today",
        "total": "Total",
        "new_payment": "Add Payment",
        "add_payment": "Add Payment",
        "add_treatment": "Add Treatment",
        "add_first_treatment": "Add First Treatment",
        "all_doctors": "All doctors",
        "select": "Select",
        "cash": "Cash",
        "card": "Card",
        "transfer": "Transfer",
        "optional": "optional",
        "created_patient": "Patient created",
        "updated_patient": "Patient updated",
        "payment_recorded": "Payment added",
        "payment_deleted": "Payment deleted",
        "treatment_deleted": "Treatment deleted",
        "edit_payment": "Edit",
        "delete_payment": "Delete",
        "delete_payment_confirm": "Are you sure you want to delete this payment?",
        "edit_payment_title": "Edit Payment",
        "delete_payment_title": "Confirm Delete Payment",
        "delete_payment_warn": "This will permanently remove this payment entry.",
        "deleted_payment_ok": "Payment deleted",
        "updated_payment_ok": "Payment updated",
        "delete_treatment": "Delete Treatment",
        "delete_treatment_confirm": "Are you sure you want to delete this treatment?",
        "this_will_delete_all_payments": "This will delete the treatment and all its payments.",
        "remove_initial_payment": "Remove initial payment",
        "remove_initial_payment_confirm": "Remove only the initial payment?",
        "remove_initial_payment_warning": "Other payments in this treatment will stay.",
        "removed_initial_payment_ok": "Initial payment removed.",
        "edit_treatment": "Edit treatment",
        "this_is_consultation_visit": "This is a consultation visit",
        "patient_header": "Patient",
        "submit_add_payment": "Add Payment",
        "back_to_patient": "Back to Patient",
        "total_amount": "Total Amount",
        "down_payment": "Paid Today",
        "remaining_amount": "Remaining Amount",
        "discount": "Discount",
        "discount_hint": "Deducted from total before remaining is calculated",
        "treatment_type": "Treatment Type",
        "treatment_name": "Treatment Name",
        "treatment_id": "Treatment ID",
        "sheet_notes": "Notes",
        "actions": "Actions",
        "balance": "Balance",
        "view": "View",
        "hide": "Hide",
        "due": "Due",
        "total_due": "Total Due",
        "complete": "Complete",
        "visit_only": "Visit Only",
        "visits": "Visits",
        "initial": "Initial",
        "first_payment": "First payment",
        "no_charge": "No charge",
        "no_treatments_yet": "No treatments yet.",
        "print": "Print",
        "print_summary": "Print Summary",
        "receipt": "Receipt",
        "error_loading": "Error loading",
        "error_deleting": "Error deleting",
        "summary_total": "Total",
        "summary_paid": "Paid",
        "summary_remaining": "Remaining",
        "summary_discount": "Discount",
        "delete_patient": "Delete Patient",
        "delete_title": "Delete Patient",
        "delete_warn": "This will permanently delete the patient and all their payments.",
        "delete_cancel": "Cancel",
        "delete_yes": "Yes, delete",
        "deleted_patient_ok": "Patient deleted",
        "err_money_too_large": "Amount is too large. Maximum is 10,000,000.00",
        "err_overpaid": "Paid Today cannot exceed Due (Total - discount).",
        "err_discount_gt_total": "Discount cannot exceed Total.",
        "visit_type": "Visit Type",
        "vt_none": "—",
        "vt_exam": "Diagnosis",
        "vt_follow": "Follow-up",
        "exam_bonus": "Consultation visit",
        "consultation_visit_name": "Consultation visit",
        "treatment_summary": "Treatment Summary",
        "payment": "Payment",
        "overall_balance": "Overall Balance",
        "back": "Back",
        "visit": "Visit",
        "collections": "Collections",
        "collections_by_doctor": "Collections by doctor",
        "tab_daily": "Daily",
        "tab_monthly": "Monthly",
        "from": "From",
        "to": "To",
        "filter": "Filter",
        "reset": "Reset",
        "collected": "Collected",
        "month": "Month",
        "view_day": "View day",
        "view_month": "View month",
        "view_range": "View range",
        "export": "Export CSV",
        "no_rows": "—",
        "dup_found_title": "Possible duplicate found",
        "dup_found_msg": "A patient with the same name/phone/file may exist.",
        "save_anyway": "Save anyway",
        "try_again": "Try again",
        "images_page_title": "Patient Images",
        "import_images": "Import",
        "select_all": "Select all",
        "clear_selection": "Clear selection",
        "export_selected": "Export selected",
        "export_all": "Export all images",
        "open_images_manager": "Images",
        # Admin → Patients settings
        "patient_settings": "Patient settings",
        "save_settings": "Save settings",
        "enable_file_numbers_simple": "Show page numbers",
        "enable_file_numbers_simple_hint": "When enabled, page number fields are shown on patient cards and forms. Turning this off hides the fields but does not delete any data.",
        # Data import
        "data_import_file_label": "Choose Excel or CSV file",
        "data_import_file_hint": "Upload a file to preview. If you do not have one yet, download the CSV template first.",
        "data_import_unsupported_file": "Unsupported file type. Please use .xlsx/.xlsm or the provided CSV template.",
        "data_import_file_required": "Please choose a file to analyze.",
        "data_import_export_payments": "Export all payments (CSV)",
        "data_import_never_auto_merge": "Safe merge (recommended)",
        "data_import_never_auto_merge_hint": "Safe mode avoids risky merges. Turn it off only if you fully understand your data.",
        "data_import_settings_saved": "Import settings saved.",
        "data_import_matched_patients": "Patients matched",
        "data_import_after_import": "After import",
        "data_import_report_dups_hint": "Review possible duplicates related to this import before continuing your work.",
        "data_import_report_dups_safe_btn": "Review duplicates (safe)",
        "data_import_report_dups_aggressive_btn": "Review duplicates (aggressive)",
        "data_import_report_dups_loading": "Scanning duplicates for this import...",
        "data_import_report_dups_none": "No duplicates found for this import.",
        "data_import_report_missing": "Import report not available. Please run an import first.",
        "data_import_report_not_found": "Import report not found.",
        "data_import_report_title": "Import report",
        "data_import_report_loading": "Loading report...",
        "data_import_report_view_summary": "View report summary",
        "data_import_report_view_conflicts": "View page conflicts",
        "data_import_reports_title": "Import reports",
        "data_import_reports_hint": "Use these to download past import reports and review duplicates later.",
        "data_import_reports_empty": "No import reports yet.",
        "data_import_page_conflicts_none": "No page conflicts were recorded in this report.",
        "data_import_payment_rows": "Payment rows",
        "data_import_patients_in_file": "Patients in file",
        "data_import_patients_no_payments_imported": "Patients created (no payments imported)",
        "data_import_skipped_zero_entries": "Skipped zero-amount rows",
        "page_number": "Page number",
        "incoming": "Incoming",
        "existing": "Existing",
        "source": "Source",
        "timestamp": "Timestamp",
        # Admin settings (general)
        "admin_settings": "Admin Settings",
        "admin_settings_intro": "Manage users, roles, permissions, and doctors you add",
        "manage_users": "Manage Users",
        "roles_permissions": "Roles & Permissions",
        "doctors": "Doctors",
        "theme": "Theme",
        "data_import": "Data import",
        "data_export": "Data export",
        "data_export_intro": "Export your clinic data as a CSV file that can be opened in Excel.",
        "data_export_hint": "This export uses the same columns as the CSV import template, so you can re-import it later if needed.",
        "data_export_sort_hint": "Export is ordered from oldest payments to newest payments.",
        "users": "Users",
        "roles": "Roles",
        "role": "Role",
        "permissions": "Permissions",
        "description": "Description",
        "status": "Status",
        "username": "Username",
        "password": "Password",
        "new_user": "New User",
        "create_user": "Create User",
        "edit_user": "Edit User",
        "update_user": "Update User",
        "new_role": "New Role",
        "create_role": "Create Role",
        "edit_role": "Edit Role",
        "update_role": "Update Role",
        "edit_doctor": "Edit Doctor",
        "admin_save_failed": "Save failed.",
        "perm_group_user_mgmt": "User Management",
        "perm_group_appointments": "Appointments",
        "perm_group_patients": "Patients",
        "perm_group_payments_receipts": "Payments & receipts",
        "perm_group_reports_exports": "Reports & exports",
        "perm_group_system_admin": "System administration",
        "perm_group_images_media": "Images & media",
        "perm_group_expenses": "Expenses",
        "left_file": "Left file",
        "right_file": "Right file",
        # Admin → Roles (sensitive actions)
        "role_sensitive_actions_title": "Sensitive actions",
        "role_sensitive_merge_label": "Merge patient files",
        "role_sensitive_merge_warning": "Moves payments/appointments; use only for managers/admin.",
        "role_permissions_search_placeholder": "Search permissions...",
        "keep_file": "Keep this file",
        "groups": "groups",
        "pairs": "pairs",
        "data_import_duplicates_counts": "Suggestions",
        "db_dup_merge_confirm": "Merge these two patient files? The source file will be deleted.",
        "db_dup_merge_ok": "Merge completed.",
        "db_dup_merge_failed": "Merge failed.",
        "dup_phone_differs": "Phone differs",
        "dup_page_differs": "Page differs",
        "dup_missing_phone": "Missing phone",
        "dup_missing_file": "Missing file #",
        "dup_missing_page": "Missing page #",
        "dup_merge_into_keep": "Merge into kept file",
        "more": "more",
        "disabled": "Disabled",
        "preview": "Preview",
        "start": "Start",
        "upload": "Upload",
        "remove": "Remove",
        "file_number": "File number",
        "reset_theme_defaults": "Reset to defaults",
        "colors": "Colors",
        "branding": "Branding",
        "pdf_branding": "PDF branding",
        "primary_color": "Primary color",
        "accent_color": "Accent color",
        "base_font_size": "Font size",
        "clinic_logo": "Clinic logo",
        "current_logo": "Current logo",
        "logo_hint": "PNG or JPG, max 2MB.",
        "remove_logo": "Remove logo",
        "past_logos": "Past logos",
        "use_selected_logo": "Use selected logo",
        "logo_size": "Logo size",
        "logo_size_hint": "Controls the logo size in the top bar.",
        "clinic_name_label": "Clinic name",
        "clinic_name_placeholder": "e.g., ISmile Dental Clinic",
        "clinic_tagline_label": "Tagline",
        "clinic_tagline_placeholder": "e.g., Dental Clinic",
        "show_clinic_name": "Show clinic name",
        "show_clinic_tagline": "Show tagline",
        "clinic_brand_color": "Brand color",
        "clinic_brand_hint": "Used for the clinic name and tagline.",
        "current_pdf_logo": "Current PDF logo",
        "theme_preview_hint": "Preview updates after saving.",
        "no_logo": "No logo uploaded",
        "range_name": "Range name",
        "patients_tab": "Patients",
        "any_doctor": "Any Doctor",
        "no_images_yet": "No images yet",
        "exam_bonus_hint": "Consultation visits do not auto-add fees.",
        "diag_adult": "Adult",
        "diag_child": "Child",
        "diag_adult_range": "Adult 1–8",
        "diag_child_range": "Child A–E",
        "patient_fallback_name": "Patient",
        "patient_id_label": "ID",
        "patient_since": "since",
        "quick_pick": "Quick-Pick",
        "diag_status_clear": "White",
        "diag_status_healthy": "Healthy",
        "diag_status_caries": "Caries",
        "diag_status_filled": "Filled",
        "diag_status_missing": "Missing",
        "diag_status_rct": "RCT",
        "diag_status_crown": "Crown",
        "diag_status_implant": "Implant",
        "diag_status_note": "Note",
        "tooth_label": "Tooth",
        "status_label": "Status",
        "notes_optional": "Optional notes...",
        "operation_failed": "Failed",
        "saved": "Saved",
        "saving": "Saving...",
        "delete_selected": "Delete selected",
        "images_drop_hint": "Drop images here or use Import",
        "rename": "Rename",
        "image": "Image",
        "prev": "Prev",
        "next": "Next",
        "page": "Page",
        "showing": "Showing",
        "go": "Go",
        "no_files": "No files",
        "upload_failed": "Upload failed",
        "duplicates_skipped": "Duplicates skipped",
        "uploaded_with_skip": "Uploaded {saved} • Skipped {skipped}",
        "uploaded_count": "Uploaded {count}",
        "no_images_selected": "No images selected",
        "delete_selected_confirm": "Delete selected images?",
        "delete_failed": "Delete failed",
        "rename_failed": "Rename failed",
        "renamed_ok": "Renamed",
        "deleted_ok": "Deleted",
        "new_name_prompt": "New name (keep extension):",
        "new_name_placeholder": "New name.ext",
        "delete_image_confirm": "Delete this image?",
        "medical_page_title": "Medical",
        "allergies_present": "Allergies Present",
        "list_allergies": "List allergies",
        "risk_flags": "Risk flags",
        "anticoagulants": "Anticoagulants",
        "prophylaxis": "Prophylaxis",
        "uncontrolled_dm": "Uncontrolled DM",
        "pregnancy_flag": "Pregnancy",
        "smoking_vaping": "Smoking/Vaping",
        "bisphosphonates_denosumab": "Bisphosphonates/Denosumab",
        "bleeding_disorder": "Bleeding disorder",
        "immunosuppression_chemo": "Immunosuppression/Chemo",
        "prosthetic_valve": "Prosthetic heart valve",
        "pacemaker_icd": "Pacemaker/ICD",
        "latex_allergy": "Latex allergy",
        "medical_notes_label": "Medical notes",
        "medical_notes_placeholder": "Anything the dentist needs to see quickly",
        "idle": "Idle",
        "delete_selected": "Delete selected",
        "images_drop_hint": "Drop images here or use Import",
        "rename": "Rename",
        "image": "Image",
        "prev": "Prev",
        "next": "Next",
        "login_bootstrap_hint": "No users exist yet. Enter a username and password to create the first admin account.",
        "clinic_spending": "Clinic spending",
        "expenses_intro": "Log what you bought and how much. We keep a clean total for the month.",
        "quick_expense_tracking": "Quick and simple expense tracking",
        "expenses": "Expenses",
        "expenses_hint": "Keep every receipt in one place. Description + price is all you need.",
        "total_this_month": "Total this month",
        "running_total": "Running total",
        "add_expense": "Add expense",
        "materials_receipts": "Materials / receipts",
        "what_did_you_buy": "What did you buy?",
        "expenses_placeholder": "e.g., gloves, disinfectant, courier fees...",
        "this_month": "This month",
        "expense": "expense",
        "s_suffix": "s",
        "view_details": "View details",
        "no_expenses": "No expenses for",
        "yet": "yet.",
        "expense_details": "Expense details",
        "close": "Close",
        "no_description": "No description provided.",
        "delete_expense_confirm": "Delete this expense?",
        "simple_expenses_title": "Simple Expenses",
        "back_to_dashboard": "Back to Dashboard",
        "delete": "Delete",
        "expenses_management_title": "Expense Management",
        "expenses_new_receipt": "New Expense Receipt",
        "expenses_enter_total": "Please enter how much you paid.",
        "expenses_searching": "Searching...",
        "expenses_receipts_title": "Expense Receipts",
        "expenses_this_month": "This month",
        "expenses_materials_spending": "Materials spending",
        "search_filter": "Search & Filter",
        "start_date": "Start Date",
        "end_date": "End Date",
        "search_description": "Search description...",
        "category": "Category",
        "clear_filters": "Clear Filters",
        "export_csv": "Export CSV",
        "export_pdf": "Export PDF",
        "expenses_receipts": "Expense Receipts",
        "new_receipt": "New Receipt",
        "description": "Description",
        "files": "Files",
        "materials_purchase": "Materials purchase",
        "uncategorized": "Uncategorized",
        "pending": "Pending",
        "update_status": "Update Status",
        "no_expense_receipts": "No Expense Receipts Found",
        "create_first_expense_receipt": "Create your first expense receipt to get started.",
        "create_first_receipt": "Create First Receipt",
        "expenses_paid_on": "Paid {amount} EGP on {date}",
        "expenses_ref": "Ref",
        "receipt_details": "Receipt Details",
        "items_count": "Items Count",
        "items": "items",
        "financial_summary": "Financial Summary",
        "collections_total": "Total collected",
        "all_time_total": "All-time total",
        "period_total": "Total for period",
        "collections_any_hint": "Doctor filter: 'All' shows every doctor. 'Any Doctor' includes Any Doctor plus deleted doctors.",
        "collections_any_hint_doctor": "'Any Doctor' here includes Any Doctor plus deleted doctors. Restore a doctor to see them separately again.",
        "total_amount": "Total Amount",
        "receipt_items": "Receipt Items",
        "material_name": "Material Name",
        "quantity": "Quantity",
        "unit_price": "Unit Price",
        "total_price": "Total Price",
        "no_items_in_receipt": "No items found in this receipt.",
        "what_you_bought": "What you bought",
        "created": "Created",
        "page_numbers": "Page numbers",
        "additional_pages": "Additional pages",
        "notebook_name": "Notebook",
        "notebook_color": "Notebook color",
        "add_page_number": "Add page",
        "page_number_placeholder": "e.g., 12 or 45–46",
        "page_notebook_placeholder": "Notebook (optional)",
        "no_page_numbers": "No page numbers yet.",
        "page_numbers_help": "Use these to match your physical patient notebook pages.",
        "page_number_added": "Page number added.",
        "page_number_removed": "Page number removed.",
        "page_number_required": "Please enter a page number.",
        "page_number_not_found": "Page number not found.",
        "page_number_add_failed": "Could not add page number.",
        "page_number_remove_failed": "Could not remove page number.",
        "merge_patient": "Merge into another file",
        "merge_target_short_id": "Target file (file no, name, or phone)",
        "merge_target_placeholder": "Type file number, name, or phone",
        "merge_diag_images_label": "Also merge diagnosis, medical history and images",
        "merge_patient_warning": "This will move all payments and appointments from this patient into the target file. Diagnosis, medical history and images are only merged when checked and only if the target has none. This action cannot be undone.",
        "merge_now": "Merge",
        "merge_target_required": "Please enter a target file number.",
        "merge_target_not_found": "Target file number not found.",
        "merge_target_ambiguous": "More than one patient has this file number. Please make the file number unique first.",
        "merge_same_patient": "Cannot merge a patient into itself.",
        "merge_target_has_diag": "Cannot merge diagnosis/medical/images because the target patient already has diagnosis or medical data.",
        "merge_conflict": "Merge could not be completed safely.",
        "merge_unexpected_error": "Unexpected error while merging patients.",
        "merge_patient_ok": "Patient records merged successfully.",
        "merge_suggested_same": "Suggested (same name)",
        "merge_suggested_search": "Search results",
        "receipt_id": "Receipt ID",
        "new_expense": "New expense",
        "log_materials_spending": "Log materials spending",
        "new_expense_hint": "Date, total paid, and a short description. No suppliers or extras.",
        "paid_hint": "How much you paid for these materials.",
        "list_everything": "List everything you bought...",
        "edit_expense_receipt": "Edit Expense Receipt",
        "edit_expense": "Edit expense",
        "edit_expense_hint": "Adjust the date, total paid, or description.",
        "save_changes": "Save Changes",
        "delete_receipt": "Delete Receipt",
        "approval_notes_placeholder": "Add approval notes, rejection reasons, or other comments...",
        "approval_notes_help": "Optional notes about the status change or approval process.",
        "status_history": "Status History",
        "receipt_label": "Receipt",
        "supplier": "Supplier",
        "expense_categories": "Expense Categories",
        "expense_categories_intro": "Organize your expense receipts by category for better tracking and reporting.",
        "new_category": "New Category",
        "no_categories_yet": "No Categories Yet",
        "create_first_category_hint": "Create your first expense category to start organizing receipts.",
        "create_first_category": "Create First Category",
        "materials": "Materials",
        "unit": "Unit",
        "price_per_unit": "Price per Unit",
        "active": "Active",
        "inactive": "Inactive",
        "new_material": "New Material",
        "no_materials_found": "No Materials Found",
        "create_first_material_hint": "Create your first material to get started.",
        "create_first_material": "Create First Material",
        "suppliers": "Suppliers",
        "new_supplier": "New Supplier",
        "contact_person": "Contact Person",
        "tax_number_short": "Tax #:",
        "no_suppliers_found": "No Suppliers Found",
        "create_first_supplier_hint": "Create your first supplier to get started.",
        "create_first_supplier": "Create First Supplier",
        "create_new_supplier": "Create New Supplier",
        "enter_supplier_name": "Enter supplier name",
        "contact_person_name": "Contact person name",
        "phone_number": "Phone number",
        "email_address": "Email address",
        "physical_address": "Physical address",
        "tax_registration_number": "Tax registration number",
        "create_new_material": "Create New Material",
        "enter_material_name": "Enter material name",
        "material_category": "Material category",
        "unit_placeholder": "e.g., kg, pcs, boxes",
        "material_description": "Material description",
        "receipt_files_title": "Receipt Files",
        "files_for_receipt": "Files for Receipt",
        "back_to_receipt": "Back to Receipt",
        "add_files": "Add Files",
        "attached_files": "Attached Files",
        "pdf_document": "PDF Document",
        "file_label": "File",
        "download": "Download",
        "no_files_attached": "No Files Attached",
        "upload_receipt_files_hint": "Upload receipt files to keep digital copies of your expense receipts.",
        "upload_first_file": "Upload First File",
        "upload_receipt_files": "Upload Receipt Files",
        "image_preview": "Image Preview",
        "delete_file_confirm": "Delete this file?",
        "delete_failed_unknown": "Failed to delete file",
        "expense_receipt_label": "Expense Receipt",
        "approved_on": "Approved on",
        "by_user": "by",
        "approval_notes": "Approval Notes",
        "supplier_information": "Supplier Information",
        "financial_details": "Financial Details",
        "subtotal": "Subtotal",
        "tax_amount": "Tax Amount",
        "item_description": "Item Description",
        "add_file": "Add File",
        "attach_files": "Attach Files",
        "file_preview": "File Preview",
        "theme_save_failed": "Failed to save theme",
        "theme_saved_reload": "Theme saved. Reload to apply.",
        "theme_unexpected_error": "Unexpected error while saving theme.",
        "theme_presets": "Theme presets",
        "theme_preset_calm": "Calm blue",
        "theme_preset_warm": "Warm gold",
        "theme_preset_mint": "Soft mint",
        "theme_pick_from_logo": "Use colors from logo",
        "admin_user_load_error": "Error loading user data",
        "admin_generic_error": "An error occurred. Please try again.",
        "admin_user_delete_confirm": "Are you sure you want to delete user \"{name}\"?",
        "admin_error_prefix": "Error:",
        "admin_role_load_error": "Error loading role data",
        "admin_role_delete_confirm": "Are you sure you want to delete role \"{name}\"?",
        "admin_role": "Role",
        "admin_permissions": "Permissions",
        "admin_more": "more",
        "admin_doctor_save_failed": "Failed to save doctor",
        "admin_doctor_save_unexpected": "Unexpected error saving doctor.",
        "admin_doctor_delete_error": "Error deleting doctor",
        "admin_doctor_deleted": "Doctor deleted.",
        "admin_doctor_delete_confirm": "Delete doctor \"{name}\"?",
        "admin_doctor_delete_confirm_simple": "Delete this doctor entry?",
        "admin_reset_colors_confirm": "Are you sure you want to reset all doctor colors to defaults?",
        "admin_unknown_error": "Unknown error",
        "doctor_name_required": "Doctor name is required.",
        "doctor": "Doctor",
        "select_doctor": "Select doctor",
        "doctor_required": "Please select a doctor.",
        "please_fix_errors": "Please fix these errors:",
        "similar_expenses_found": "Similar Expenses Found",
        "duplicates_hint": "We found expenses that might be duplicates. You can:",
        "merge_existing": "Merge with Existing",
        "merge_existing_hint": "Choose an existing expense to update instead of creating a new one:",
        "merge_with_selected": "Merge with Selected",
        "add_as_new": "Add as New Expense",
        "add_new_hint": "Keep this as a separate expense entry:",
        "add_anyway": "Add Anyway",
        "specific_help": "Be specific to help with future searches",
        "save_expense": "Save expense",
        "no_permissions": "No permissions",
        "add_doctor": "Add Doctor",
        "reset_to_defaults": "Reset to Defaults",
        "current_color": "Current Color",
        "deleted_doctors": "Deleted Doctors",
        "last_color": "Last Color",
        "deleted_at": "Deleted At",
        "doctor_id": "Doctor ID",
        "generated_automatically": "Will be generated automatically",
        "doctor_name": "Doctor Name",
        "color": "Color",
        "theme_preview_title": "Theme Preview",
        "theme_text_color": "Text color",
        "theme_text_color_hint": "Used for main text and labels.",
        "theme_btn_text_color": "Button text color",
        "theme_btn_text_color_hint": "Used for text on primary themed buttons and stats.",
        "theme_metric_color": "Highlight numbers color",
        "theme_metric_color_hint": "Used for big numbers like patient count and totals.",
        "theme_page_bg_tint": "Page background tint",
        "theme_page_bg_tint_hint": "Very light color mixed into the overall page background.",
        "theme_card_bg_tint": "Card accent tint",
        "theme_card_bg_tint_hint": "Optional soft tint for special header cards. Regular cards stay mostly white.",
        "save_theme": "Save Theme",
        "login_bootstrap_hint": "No users exist yet. Enter a username and password to create the first admin account.",
        "clinic_spending": "Clinic spending",
        "expenses_intro": "Log what you bought and how much. We keep a clean total for the month.",
        "quick_expense_tracking": "Quick and simple expense tracking",
        "please_fix_errors": "Please fix these errors:",
        "similar_expenses_found": "Similar Expenses Found",
        "duplicates_hint": "We found expenses that might be duplicates. You can:",
        "merge_existing": "Merge with Existing",
        "merge_existing_hint": "Choose an existing expense to update instead of creating a new one:",
        "merge_with_selected": "Merge with Selected",
        "add_as_new": "Add as New Expense",
        "add_new_hint": "Keep this as a separate expense entry:",
        "add_anyway": "Add Anyway",
        "specific_help": "Be specific to help with future searches",
        "save_expense": "Save expense",
        "method_cash": "Cash",
        "method_card": "Card",
        "method_transfer": "Transfer",
        "method_other": "Other",
        "appointments": "Appointments",
        "global_search_placeholder": "Search patients...",
        "no_results_found": "No results found",
        "searching": "Searching...",
        "appointment": "Appointment",
        "new": "New",
        "today": "Today",
        "yesterday": "Yesterday",
        "tomorrow": "Tomorrow",
        "all": "All",
        "end": "End",
        "appointments_today": "Today's schedules",
        "appointments_new": "Plan Appointment",
        "appointments_filters": "Filters",
        "appointments_day_label": "Day",
        "appointments_doctor_label": "Doctor",
        "appointments_doctor_all": "All doctors",
        "appointments_slot_label": "Start time",
        "appointments_duration_label": "Duration (minutes)",
        "appointments_notes_label": "Visit notes",
        "appointments_patient_lookup": "Patient (file # or name)",
        "appointments_patient_name": "Patient name (optional)",
        "appointments_patient_phone": "Phone (optional)",
        "appointments_title_label": "Visit title",
        "appointments_submit": "Save appointment",
        "appointments_empty_hour": "No appointments booked for this hour.",
        "appointments_range_label": "Range",
        "appointments_range_today": "Today only",
        "appointments_range_next3": "Next 3 days",
        "appointments_range_next7": "Next 7 days",
        "appointments_range_all": "All upcoming",
        "appointments_show_label": "Show",
        "appointments_show_upcoming": "Upcoming only",
        "appointments_show_past": "Past only",
        "appointments_show_all": "All schedules",
        "appointments_search_label": "Search",
        "appointments_total_label": "Total schedules",
        "appointments_search_placeholder": "Patient name, phone, or file #",
        "appointments_no_notes": "No notes",
        "appointment_conflict": "Another visit already occupies this slot.",
        "appointment_status_scheduled": "Scheduled",
        "appointment_status_checked_in": "Checked in",
        "appointment_status_in_progress": "In progress",
        "appointment_status_done": "Done",
        "appointment_status_no_show": "No-show",
        "appointment_status_cancelled": "Cancelled",
        "appointments_more_chip": "+{count} more",
        "appointment_edit_title": "Edit Appointment",
        "appointment_update_btn": "Update Appointment",
        "appointment_deleted": "Appointment deleted",
        "appointment_delete_failed": "Failed to delete appointment.",
        "appointments_found_count": "Found {count} appointments",
        "appointments_show_all_count": "Showing all {count} appointments",
        "appointments_generic_error": "An error occurred",
        "receivables": "Outstanding balances",
        "receivables_total": "Total owed to clinic",
        "receivables_patients": "Patients owing money",
        "appointment_delete_title": "Delete Appointment",
        "appointment_delete_working": "Deleting...",
        "appointments_search_error": "Error searching patients",
        "appointment_loading": "Loading...",
        "appointment_patient_label": "Patient",
        "appointment_patient_placeholder": "Type patient name, file number, or phone...",
        "appointment_doctor_label": "Doctor",
        "appointment_choose_doctor": "Choose a doctor",
        "appointment_status_label": "Status",
        "appointment_date_label": "Date",
        "appointment_start_time_label": "Start Time",
        "appointment_start_time_placeholder": "Select time",
        "appointment_title_label": "Title",
        "appointment_title_placeholder": "e.g., Checkup, Filling...",
        "appointment_time_label": "Time",
        "appointment_view_title": "View Appointment",
        "appointment_delete_confirm": "Are you sure you want to delete the appointment for",
        "appointment_delete_warning": "This action cannot be undone.",
        "change_status": "Change Status",
        "appointment_save_failed": "Failed to save appointment.",
        "appointment_updated": "Appointment updated",
        "appointment_added": "Appointment added",
        "unknown_patient": "Unknown Patient",
        "no_reason_provided": "No reason provided",
        "appointment_start_time_required": "Time is required",
        "appointments_end_date": "End date",
        "edit": "Edit",
        "admin_settings": "Admin Settings",
        "admin_settings_intro": "Manage users, roles, permissions, and doctors you add",
        "data_import": "Data import",
        "data_import_intro": "Import clinic data from a file in a safe, two-step process.",
        "data_import_first_stable_hint": "Use the CSV template for best results. You can also upload your own Excel file if it matches the template columns.",
        "data_import_preview_btn": "Analyze file (no changes)",
        "data_import_summary": "Preview of rows",
        "data_import_preview_only_note": "This step does not write anything to the database. After you review the preview, use the Import button to add the data to your clinic database.",
        "data_import_download_template": "Download CSV template",
        "data_import_commit_title": "Import into clinic database",
        "data_import_commit_help": "This will add patients and payments to your real clinic database. A backup will be created automatically first.",
        "data_import_skip_duplicates": "Skip rows already imported (recommended)",
        "data_import_import_zero_entries": "Import zero-amount entries (history rows)",
        "data_import_commit_btn": "Import to clinic (writes to database)",
        "data_import_download_report": "Download import report",
        "data_import_loading": "Analyzing file...",
        "data_import_preview_failed": "Could not read file.",
        "data_import_preview_ok": "Preview generated.",
        "data_import_no_rows": "No usable rows were found in the file.",
        "data_import_total_rows": "Rows",
        "data_import_patients": "Patients",
        "data_import_payments": "Payments",
        "data_import_zero_entries": "Zero-amount entries",
        "data_import_zero_entries_in_file": "Zero-amount entries (in file)",
        "data_import_skipped_rows": "Skipped empty rows",
        "data_import_missing_file": "Missing file number",
        "data_import_missing_name": "Missing name",
        "data_import_unexpected": "Unexpected error while reading file.",
        "data_import_commit_confirm": "This will write to your real clinic database and may take a minute. A backup will be created first. Continue?",
        "data_import_commit_running": "Importing... Please wait.",
        "data_import_commit_ok": "Import completed.",
        "data_import_commit_failed": "Import failed.",
        "data_import_preflight_btn": "Check import (no changes)",
        "data_import_preflight_running": "Checking import against your database...",
        "data_import_preflight_ok": "Import check completed.",
        "data_import_preflight_failed": "Import check failed.",
        "data_import_new_patients": "New patients",
        "data_import_new_payments": "New payments",
        "data_import_unknown_dates": "Unknown dates (left blank)",
        "audit_tab_title": "Audit",
        "audit_payments_title": "Payments audit log",
        "audit_user_hint": "username",
        "audit_payment_create": "Payment added",
        "audit_payment_update": "Payment updated",
        "audit_payment_delete": "Payment deleted",
        "audit_load_failed": "Could not load audit log.",
        "audit_privacy_title": "Audit privacy",
        "audit_snapshots_title": "Patient snapshots",
        "audit_snapshots_enabled": "Store patient snapshots (name + file/page)",
        "audit_snapshots_retention": "Keep snapshots for",
        "audit_snapshots_help": "Snapshots keep the audit readable even if a patient is later deleted. You can purge snapshots any time; audit events remain.",
        "audit_snapshots_help_deleted": "Already-deleted patients cannot be recovered and will show as “Unknown patient”.",
        "audit_privacy_load_failed": "Could not load privacy settings.",
        "audit_privacy_saved": "Saved.",
        "audit_privacy_save_failed": "Save failed.",
        "audit_snapshots_table_missing": "Snapshots table not found. Run Run-Migrations.bat.",
        "audit_snapshots_count": "Saved snapshots",
        "audit_snapshots_backfill": "Backfill",
        "audit_snapshots_purge_expired": "Purge expired",
        "audit_snapshots_purge_all": "Purge all",
        "audit_snapshots_backfill_running": "Backfilling...",
        "audit_snapshots_backfill_ok": "Backfill completed.",
        "audit_snapshots_backfill_failed": "Backfill failed.",
        "audit_snapshots_purge_running": "Purging...",
        "audit_snapshots_purge_ok": "Purged snapshots.",
        "audit_snapshots_purge_failed": "Purge failed.",
        "audit_snapshots_purge_all_confirm": "Delete ALL saved snapshots? Audit events will remain.",
        "audit_snapshots_view": "View snapshots",
        "audit_snapshots_load_failed": "Could not load snapshots.",
        "audit_view_title": "Audit entry",
        "audit_prev_not_recorded": "(previous value not recorded)",
        "changes": "Changes",
        "before": "Before",
        "after": "After",
        "current": "Current",
        "technical_details": "Technical details",
        "audit_confirm_backfill_title": "Backfill snapshots",
        "audit_confirm_backfill_msg": "This will create snapshots for old audit entries where the patient still exists. Continue?",
        "audit_confirm_purge_expired_title": "Purge expired snapshots",
        "audit_confirm_purge_expired_msg": "This will delete snapshots older than your retention setting. Audit events will remain. Continue?",
        "audit_confirm_purge_all_title": "Purge all snapshots",
        "audit_confirm_purge_all_msg": "This will delete ALL saved snapshots. Audit events will remain. Continue?",
        "audit_confirm_purge_all_ok": "Delete all",
        "name_or_file": "Name / file / page",
        "details": "Details",
        "data_analyze_mode_label": "Analyze mode",
        "data_analyze_mode_safe": "Safe",
        "data_analyze_mode_normal": "Normal",
        "data_analyze_mode_aggressive": "Aggressive",
        "data_analyze_mode_tip": "Safe: page + exact name (phone when present). Normal: page + exact name (phone optional). Aggressive: name only.",
        "summary": "Summary",
        "warnings": "Warnings",
        "options": "Options",
        "mode": "Mode",
        "data_import_skip_duplicates_short": "Duplicates skipped",
        "data_import_skip_edited_rows_short": "Edited old rows skipped",
        "duplicate_phone_in_file": "Duplicate phone number in this patient file. Keep each number only once.",
        "data_import_opt_skip_duplicates": "Skip duplicates",
        "data_import_opt_import_zero_entries": "Import zero-amount entries",
        "data_import_opt_safe_merge": "Safe merge",
        "data_import_page_conflicts": "Page number conflicts",
        "data_import_commit_only_main_db": "Import is disabled in preview mode. Please run the normal app (Start-Clinic.bat) to import into your real clinic database.",
        "data_import_backup_failed": "Could not create database backup",
        "data_import_schema_missing": "Your clinic database is missing required payment fields ({cols}). Please run Run-Migrations.bat, then try again.",
        "data_import_db_duplicates_title": "Possible duplicates in your database",
        "data_import_db_duplicates_hint": "This scans your current clinic database for possible duplicates. Nothing is merged automatically.",
        "data_import_db_duplicates_scan_simple_btn": "Scan duplicates",
        "data_import_db_duplicates_safe_btn": "Scan (safe)",
        "data_import_db_duplicates_normal_btn": "Scan (normal)",
        "data_import_db_duplicates_aggressive_btn": "Scan (aggressive)",
        "data_import_db_duplicates_idle": "Press Scan to check duplicates.",
        "data_import_db_duplicates_loading": "Scanning database...",
        "data_import_db_duplicates_none": "No duplicates found.",
        "data_import_db_duplicates_mode_safe": "Safe mode: match by name + same/missing phone.",
        "data_import_db_duplicates_mode_normal": "Normal mode: match by name + same phone/page (or missing phone).",
        "data_import_db_duplicates_mode_aggressive": "Aggressive mode: match by name only.",
        "data_db_duplicates_mode_tip": "Safe: name + same/missing phone. Normal: name + same phone/page. Aggressive: name only.",
        "dup_reason_same_phone": "Same phone",
        "dup_reason_same_page": "Same page",
        "dup_reason_name_only": "Name only",
        "data_import_report_dups_normal_btn": "Review duplicates (normal)",
        "data_tab_simple": "Simple",
        "data_tab_advanced": "Advanced",
        "data_tab_mode_hint": "Use Advanced only when needed.",
        "data_tab_title": "Data",
        "data_sub_import": "Import",
        "data_sub_analyze": "Analyze",
        "data_sub_duplicates": "Duplicates",
        "data_sub_export": "Export",
        "data_sub_reports": "Reports",
        "data_sub_backups": "Backups",
        "data_file_title": "Selected file",
        "data_file_none": "No file selected.",
        "data_file_clear": "Clear",
        "data_step_1": "Step 1",
        "data_step_2": "Step 2",
        "data_step_3": "Step 3",
        "data_import_search_hint": "Search name, phone, file #, or page #",
        "db_backups_title": "Database backups",
        "db_backups_hint": "Backups are created automatically before each import. You can also create one manually here.",
        "db_backups_loading": "Loading backups...",
        "db_backups_load_failed": "Could not load backups.",
        "db_backups_empty": "No backups yet.",
        "db_backup_create_now": "Create backup now",
        "db_backup_created": "Backup created.",
        "db_backup_failed": "Backup failed.",
        "db_backups_restore_note": "Restore is safest when the app is closed. If you need to restore, tell me and I will add a guided restore workflow.",
        "db_backup_restore_confirm": "Restore this backup? The app will close, then reopen it with Start-Clinic.bat.",
        "db_backup_restore_running": "Restoring... the app will close now.",
        "db_backup_restore_ok": "Restore scheduled. Please reopen the app.",
        "db_backup_restore_failed": "Restore failed.",
        "db_backup_restore_scheduled": "Restore scheduled. The app will close now. Reopen using Start-Clinic.bat.",
        "db_backup_invalid": "Invalid backup file.",
        "db_backup_not_found": "Backup not found.",
        "data_import_page_conflicts": "Page number conflicts",
        "open": "Open",
        "download": "Download",
        "refresh": "Refresh",
        "file": "File",
        "size": "Size",
        "data_import_file_not_found": "File not found.",
        "data_import_view_payments": "View payments",
        "data_import_status_done": "Done",
        "data_import_status_owing": "Owing",
        "loading": "Loading...",
        "font_clamp_hint": "Clamped to 14–18px to protect layout.",
        "admin_deleted_doctors_empty": "No deleted doctors.",
        "admin_restore": "Restore",
        "admin_delete_permanent": "Delete Permanently",
        "medical": "Medical",
        "receipts": "Receipts",
        "receipts_new": "Issue Receipt",
        "receipts_recent": "Recent receipts",
        "receipts_patient_placeholder": "File # or name",
        "receipt_lookup_hint": "P000123",
        "receipts_description_placeholder": "Description shown on the receipt",
        "receipts_amount": "Amount",
        "receipts_locale": "Language",
        "receipts_pdf": "Download PDF",
        "receipts_reprint": "Reprint",
        "receipts_success": "Receipt issued",
        "receipts_reprint_done": "Reprint saved",
        "receipt_heading": "Clinic Receipt",
        "receipt_number_label": "Receipt No.",
        "receipt_date_label": "Date",
        "receipt_patient_label": "Patient",
        "receipt_phone_label": "Phone",
        "receipt_description_label": "Description",
        "receipt_amount_label": "Amount",
        "receipt_qr_hint": "QR payload",
        "receipt_default_desc": "Dental services",
        "appointments_table_missing": "Run `flask db upgrade` to enable appointments.",
        "receipts_table_missing": "Run `flask db upgrade` to enable receipts.",
        "amount_required": "Enter a valid amount",
        "patient_not_found": "Patient not found",
        "receipt_not_found": "Receipt not found",
        "title_required": "Title is required",
        "invalid_status": "Invalid status",
        "invalid_datetime": "Invalid date or time",
        "roles_manage_title": "Roles & permissions",
        "roles_new_button": "New role",
        "roles_edit_heading": "Edit role",
        "role_form_name": "Role name",
        "role_form_description": "Description",
        "role_form_permissions": "Permissions",
        "role_permissions_hint": "Select the allowed actions for this role.",
        "role_created": "Role created",
        "role_updated": "Role updated",
        "role_exists": "Role name already exists.",
        "role_name_required": "Role name must be at least 2 characters.",
        "role_not_found": "Role not found",
        # Print Receipt Features
        "print_receipt": "Print Receipt",
        "print_receipt_title": "Print Payment Receipt",
        "print_scope": "Print Scope",
        "payment_only": "Payment Only",
        "payment_snapshot": "Payment Receipt + Treatment Summary",
        "payment_summary": "Payment Summary",
        "view_receipt": "View Receipt",
        "receipt_format": "Receipt Format",
        "format_full": "Full",
        "format_summary": "Summary",
        "format_treatment": "Treatment",
        "format_payment": "Payment Only",
        "preview_receipt": "Preview Receipt",
        "print_confirmation": "Do you want to print the receipt?",
        "receipt_generation_error": "Error generating receipt: {error}",
        "receipt_downloaded": "Receipt downloaded successfully",
        "print_loading": "Generating receipt...",
        "print_success": "Receipt printed successfully",
        "print_error": "Failed to generate receipt. Please try again.",
        "include_qr": "Include QR Code",
        "include_notes": "Treatment Notes",
        "include_payment_notes": "Payment Notes",
        "treatment_notes": "Treatment Notes",
        "payment_notes": "Payment Notes",
        "include_treatment": "Include treatment details",
        "add_watermark": "Add Copy Watermark",
        "download_pdf": "Download PDF",
        # PDF specific keys
        "patient_name": "Patient Name",
        "file_no": "File Number",
        "payment_date": "Payment Date",
        "payment_method": "Payment Method",
        "total_amount": "Total Amount",
        "discount": "Discount",
        "paid_amount": "Paid Amount",
        "remaining_balance": "Remaining Balance",
        "treatment": "Treatment",
        "patient": "Patient",
        "date": "Date",
        "amount_paid": "Amount Paid",
        "method": "Method",
        "treatment_date": "Treatment Date",
        "total_cost": "Total Cost",
        "amount": "Amount",
        "reference": "Reference",
        "paid": "Paid",
        "receipt_id_label": "Receipt ID: {receipt_id}",
        "generated_label": "Generated: {current_time}",
        "thank_you_message": "Thank you for choosing our clinic!",
        # Copy watermark feature
        "copy_watermark": "CLINIC COPY",
        "copy_watermark_description": "Marks receipts as clinic copies for internal use",
    },
    "ar": {
        "app_title": "تطبيق العيادة",
        "home": "الرئيسية",
        "add_patient": "+ مريض",
        "export_patients": "تصدير المرضى (CSV)",
        "export_payments": "تصدير المدفوعات (CSV)",
        "backup": "نسخة احتياطية (ZIP)",
        "login": "تسجيل الدخول",
        "logout": "تسجيل الخروج",
        "lang_en": "English",
        "lang_ar": "العربية",
        "search_placeholder": "ابحث بالاسم أو الهاتف أو رقم الملف أو رقم الصفحة",
        "search": "بحث",
        "matched": "مطابق",
        "clear": "مسح",
        "sort_oldest_first": "الأقدم أولاً",
        "sort_newest_first": "الأحدث أولاً",
        "patients": "عدد المرضى",
        "total_received": "تحصيل اليوم",
        "no_patients": "لا يوجد مرضى بعد. أضف مريضًا.",
        "file_no": "رقم الملف",
        "file_no_hint": "اتركه فارغًا ليتم إنشاؤه تلقائيًا (مثل P000123).",
        "file_no_exists": "رقم الملف موجود بالفعل. اختر رقمًا آخر.",
        "dup_patient_name": "يوجد مريض بنفس الاسم بالفعل.",
        "dup_patient_name_allowed": "تم حفظ اسم مكرر.",
        "dup_patient_name_confirm": "يوجد مريض بنفس الاسم. هل تريد المتابعة؟",
        "auto_short_id": "رقم الملف مستخدم. تم إنشاء رقم تلقائي.",
        "merge_patient": "دمج في ملف آخر",
        "merge_target_short_id": "الملف المستهدف (رقم الملف أو الاسم أو الهاتف)",
        "merge_target_placeholder": "اكتب رقم الملف أو الاسم أو الهاتف",
        "merge_diag_images_label": "دمج التشخيص والتاريخ الطبي والصور أيضًا",
        "merge_patient_warning": "سيتم نقل كل المدفوعات والمواعيد من هذا المريض إلى الملف المستهدف. لا يتم دمج التشخيص/التاريخ الطبي/الصور إلا إذا تم اختيار ذلك. هذا الإجراء لا يمكن التراجع عنه.",
        "merge_now": "دمج",
        "merge_target_required": "من فضلك أدخل رقم الملف المستهدف.",
        "merge_target_not_found": "لم يتم العثور على رقم الملف المستهدف.",
        "merge_target_ambiguous": "يوجد أكثر من مريض بنفس رقم الملف. من فضلك اجعل رقم الملف فريداً أولاً.",
        "merge_same_patient": "لا يمكن دمج المريض في نفسه.",
        "merge_target_has_diag": "لا يمكن دمج التشخيص/التاريخ الطبي/الصور لأن المريض المستهدف لديه بيانات طبية بالفعل.",
        "merge_conflict": "تعذر إتمام عملية الدمج بأمان.",
        "merge_unexpected_error": "حدث خطأ غير متوقع أثناء دمج المرضى.",
        "merge_patient_ok": "تم دمج بيانات المريض بنجاح.",
        "merge_suggested_same": "اقتراحات (نفس الاسم)",
        "merge_suggested_search": "نتائج البحث",
        "name": "الاسم",
        "phone": "رقم التلفون",
        "phone_numbers": "أرقام الهاتف",
        "phone_label": "وصف الرقم",
        "primary_phone": "الرقم الأساسي",
        "additional_phones": "أرقام هاتف إضافية",
        "add_phone": "إضافة رقم",
        "remove": "إزالة",
        "notes": "ملاحظات",
        "cancel": "إلغاء",
        "save": "حفظ",
        "update": "تحديث",
        "new_patient": "مريض جديد",
        "open": "فتح",
        "edit_patient": "تعديل بيانات المريض",
        "payments": "المدفوعات",
        "treatments": "العلاجات",
        "diagnosis": "التشخيص",
        "date": "التاريخ",
        "method": "الطريقة",
        "amount": "مدفوع اليوم",
        "total": "الإجمالي",
        "new_payment": "إضافة دفعة",
        "add_payment": "إضافة دفعة",
        "add_treatment": "إضافة علاج",
        "add_first_treatment": "إضافة أول علاج",
        "all_doctors": "كل الأطباء",
        "select": "اختر",
        "cash": "نقدي",
        "card": "بطاقة",
        "transfer": "تحويل",
        "optional": "اختياري",
        "created_patient": "تم إنشاء المريض",
        "updated_patient": "تم تحديث بيانات المريض",
        "payment_recorded": "تمت إضافة الدفعة",
        "payment_deleted": "تم حذف الدفعة",
        "treatment_deleted": "تم حذف العلاج",
        "edit_payment": "تعديل",
        "delete_payment": "حذف",
        "delete_payment_confirm": "هل تريد حذف هذه الدفعة؟",
        "edit_payment_title": "تعديل الدفعة",
        "delete_payment_title": "تأكيد حذف الدفعة",
        "delete_payment_warn": "سيتم حذف الدفعة بشكل نهائي.",
        "deleted_payment_ok": "تم حذف الدفعة",
        "updated_payment_ok": "تم تحديث الدفعة",
        "delete_treatment": "حذف العلاج",
        "delete_treatment_confirm": "هل تريد حذف هذا العلاج؟",
        "this_will_delete_all_payments": "سيتم حذف العلاج وجميع الدفعات التابعة له.",
        "remove_initial_payment": "إزالة الدفعة الأولى",
        "remove_initial_payment_confirm": "إزالة الدفعة الأولى فقط؟",
        "remove_initial_payment_warning": "ستبقى باقي الدفعات داخل هذا العلاج.",
        "removed_initial_payment_ok": "تمت إزالة الدفعة الأولى.",
        "edit_treatment": "تعديل العلاج",
        "this_is_consultation_visit": "هذه زيارة كشف",
        "patient_header": "المريض",
        "submit_add_payment": "إضافة الدفعة",
        "back_to_patient": "رجوع لملف المريض",
        "total_amount": "اجمالي المبلغ",
        "down_payment": "دفعة اليوم",
        "remaining_amount": "المتبقي",
        "discount": "خصم",
        "discount_hint": "يطرح من الإجمالي قبل حساب المتبقي",
        "treatment_type": "نوع العلاج",
        "treatment_name": "اسم العلاج",
        "treatment_id": "معرف العلاج",
        "sheet_notes": "ملاحظات",
        "actions": "إجراءات",
        "balance": "الرصيد",
        "view": "عرض",
        "hide": "إخفاء",
        "due": "المتبقي",
        "total_due": "إجمالي المتبقي",
        "complete": "مكتمل",
        "visit_only": "زيارة فقط",
        "visits": "زيارات",
        "initial": "الدفعة الأولى",
        "first_payment": "الدفعة الأولى",
        "no_charge": "بدون رسوم",
        "no_treatments_yet": "لا يوجد علاجات بعد.",
        "print": "طباعة",
        "print_summary": "طباعة الملخص",
        "receipt": "الإيصال",
        "error_loading": "تعذر التحميل",
        "error_deleting": "تعذر الحذف",
        "summary_total": "الإجمالي",
        "summary_paid": "المدفوع",
        "summary_remaining": "المتبقي",
        "summary_discount": "الخصم",
        "delete_patient": "حذف المريض",
        "delete_title": "حذف المريض",
        "delete_warn": "سيتم حذف المريض وكل مدفوعاته بشكل نهائي.",
        "delete_cancel": "إلغاء",
        "delete_yes": "نعم، حذف",
        "deleted_patient_ok": "تم حذف المريض",
        "err_money_too_large": "المبلغ كبير جدًا. الحد الأقصى 10,000,000.00",
        "err_overpaid": "لا يمكن أن تتجاوز دفعة اليوم المستحق (الإجمالي - الخصم).",
        "err_discount_gt_total": "لا يمكن أن يتجاوز الخصم الإجمالي.",
        "visit_type": "نوع الزيارة",
        "vt_none": "—",
        "vt_exam": "التشخيص",
        "vt_follow": "متابعة",
        "exam_bonus": "زيارة استشارة",
        "consultation_visit_name": "زيارة استشارة",
        "treatment_summary": "ملخص العلاج",
        "payment": "دفعة",
        "overall_balance": "الرصيد الكلي",
        "back": "رجوع",
        "visit": "الزيارة",
        "page_numbers": "أرقام الصفحات",
        "additional_pages": "صفحات إضافية",
        "notebook_name": "الدفتر",
        "notebook_color": "لون الدفتر",
        "add_page_number": "إضافة صفحة",
        "page_number_placeholder": "مثال: 12 أو 45–46",
        "page_notebook_placeholder": "دفتر (اختياري)",
        "no_page_numbers": "لا توجد أرقام صفحات بعد.",
        "page_numbers_help": "استخدم هذه الخانة لتطابق صفحات دفتر المرضى الورقي.",
        "page_number_added": "تمت إضافة رقم الصفحة.",
        "page_number_removed": "تمت إزالة رقم الصفحة.",
        "page_number_required": "من فضلك أدخل رقم الصفحة.",
        "page_number_not_found": "لم يتم العثور على رقم الصفحة.",
        "page_number_add_failed": "تعذر إضافة رقم الصفحة.",
        "page_number_remove_failed": "تعذر إزالة رقم الصفحة.",
        "collections": "التحصيلات",
        "collections_by_doctor": "التحصيلات حسب الطبيب",
        "all_time_total": "الإجمالي طوال الفترة",
        "period_total": "إجمالي الفترة الحالية",
        "collections_any_hint": "فلتر الطبيب: \"الكل\" يظهر كل الأطباء. \"أي طبيب\" يشمل أي طبيب بالإضافة إلى الأطباء المحذوفين مؤقتًا.",
        "collections_any_hint_doctor": "\"أي طبيب\" هنا يشمل أي طبيب والأطباء المحذوفين مؤقتًا. عند استعادة الطبيب يظهر كخانة مستقلة مرة أخرى.",
        "tab_daily": "يومي",
        "tab_monthly": "شهري",
        "from": "من",
        "to": "إلى",
        "filter": "تصفية",
        "reset": "إعادة ضبط",
        "collected": "المتحصل",
        "month": "الشهر",
        "view_day": "عرض اليوم",
        "view_month": "عرض الشهر",
        "view_range": "عرض الفترة",
        "export": "تصدير CSV",
        "no_rows": "—",
        "dup_found_title": "تم العثور على تكرار محتمل",
        "dup_found_msg": "قد يوجد مريض بنفس الاسم/الهاتف/رقم الملف.",
        "save_anyway": "حفظ على أي حال",
        "try_again": "حاول مرة أخرى",
        "images_page_title": "صور المريض",
        "import_images": "استيراد",
        "select_all": "تحديد الكل",
        "clear_selection": "مسح التحديد",
        "export_selected": "تصدير المحدد",
        "export_all": "تصدير كل الصور",
        "open_images_manager": "الصور",
        # إعدادات المرضى في لوحة الإدارة
        "patient_settings": "إعدادات المرضى",
        "save_settings": "حفظ الإعدادات",
        "enable_file_numbers_simple": "إظهار أرقام الصفحات",
        "enable_file_numbers_simple_hint": "عند التفعيل يتم إظهار خانة رقم الصفحة في ملفات المرضى والنماذج. إيقافها يخفي الخانة فقط ولا يحذف أي بيانات.",
        # استيراد البيانات
        "data_import_file_label": "اختر ملف Excel أو CSV",
        "data_import_file_hint": "ارفع ملفًا للمعاينة. إذا لم يكن لديك ملف بعد، حمّل قالب CSV أولاً.",
        "data_import_unsupported_file": "نوع الملف غير مدعوم. من فضلك استخدم ‎.xlsx/.xlsm‎ أو قالب CSV المرفق.",
        "data_import_file_required": "يرجى اختيار ملف للمعاينة.",
        "data_import_export_payments": "تصدير جميع المدفوعات (CSV)",
        "data_import_never_auto_merge": "دمج آمن (موصى به)",
        "data_import_never_auto_merge_hint": "الوضع الآمن يتجنب الدمج الخاطئ. عطّله فقط إذا كنت متأكدًا من بياناتك.",
        "data_import_settings_saved": "تم حفظ إعدادات الاستيراد.",
        "data_import_matched_patients": "مطابقة المرضى",
        "data_import_after_import": "بعد الاستيراد",
        "data_import_report_dups_hint": "راجع التكرارات المحتملة المرتبطة بهذا الاستيراد قبل متابعة عملك.",
        "data_import_report_dups_safe_btn": "مراجعة التكرارات (آمن)",
        "data_import_report_dups_aggressive_btn": "مراجعة التكرارات (موسع)",
        "data_import_report_dups_loading": "جارٍ البحث عن تكرارات لهذا الاستيراد...",
        "data_import_report_dups_none": "لا توجد تكرارات لهذا الاستيراد.",
        "data_import_report_missing": "تقرير الاستيراد غير متاح. قم بإجراء استيراد أولاً.",
        "data_import_report_not_found": "لم يتم العثور على تقرير الاستيراد.",
        "data_import_report_title": "تقرير الاستيراد",
        "data_import_report_loading": "جارٍ تحميل التقرير...",
        "data_import_report_view_summary": "عرض ملخص التقرير",
        "data_import_report_view_conflicts": "عرض تعارضات الصفحات",
        "data_import_reports_title": "تقارير الاستيراد",
        "data_import_reports_hint": "استخدمها لتنزيل تقارير الاستيراد السابقة ومراجعة التكرارات لاحقاً.",
        "data_import_reports_empty": "لا توجد تقارير استيراد بعد.",
        "data_import_page_conflicts_none": "لا توجد تعارضات صفحات مسجلة في هذا التقرير.",
        "data_import_payment_rows": "صفوف الدفعات",
        "data_import_patients_in_file": "المرضى في الملف",
        "data_import_patients_no_payments_imported": "ملفات أُنشئت بدون دفعات (لم يتم استيراد دفعات)",
        "data_import_skipped_zero_entries": "تخطي صفوف بدون مبالغ",
        "page_number": "رقم الصفحة",
        "incoming": "الوارد",
        "existing": "الموجود",
        "source": "المصدر",
        "timestamp": "الوقت",
        # لوحة الإدارة (عام)
        "admin_settings": "إعدادات الإدارة",
        "admin_settings_intro": "إدارة المستخدمين والأدوار والصلاحيات والأطباء الذين تضيفهم",
        "manage_users": "إدارة المستخدمين",
        "roles_permissions": "الأدوار والصلاحيات",
        "doctors": "الأطباء",
        "theme": "المظهر",
        "data_import": "استيراد البيانات",
        "data_export": "تصدير البيانات",
        "data_export_intro": "صدّر بيانات عيادتك كملف CSV يمكن فتحه في Excel.",
        "data_export_hint": "يستخدم التصدير نفس أعمدة قالب الاستيراد، لذا يمكنك إعادة استيراده لاحقاً إذا لزم الأمر.",
        "data_export_sort_hint": "التصدير مرتب من أقدم المدفوعات إلى أحدث المدفوعات.",
        "users": "المستخدمون",
        "roles": "الأدوار",
        "role": "الدور",
        "permissions": "الصلاحيات",
        "description": "الوصف",
        "status": "الحالة",
        "username": "اسم المستخدم",
        "password": "كلمة المرور",
        "new_user": "مستخدم جديد",
        "create_user": "إنشاء مستخدم",
        "edit_user": "تعديل المستخدم",
        "update_user": "تحديث المستخدم",
        "new_role": "دور جديد",
        "create_role": "إنشاء دور",
        "edit_role": "تعديل الدور",
        "update_role": "تحديث الدور",
        "edit_doctor": "تعديل الطبيب",
        "admin_save_failed": "فشل الحفظ.",
        "perm_group_user_mgmt": "إدارة المستخدمين",
        "perm_group_appointments": "المواعيد",
        "perm_group_patients": "المرضى",
        "perm_group_payments_receipts": "المدفوعات والإيصالات",
        "perm_group_reports_exports": "التقارير والتصدير",
        "perm_group_system_admin": "إدارة النظام",
        "perm_group_images_media": "الصور والوسائط",
        "perm_group_expenses": "المصروفات",
        "left_file": "الملف الأيسر",
        "right_file": "الملف الأيمن",
        # Admin → Roles (sensitive actions)
        "role_sensitive_actions_title": "إجراءات حساسة",
        "role_sensitive_merge_label": "دمج ملفات المرضى",
        "role_sensitive_merge_warning": "ينقل المدفوعات والمواعيد؛ استخدمه فقط للمدير/المسؤول.",
        "role_permissions_search_placeholder": "ابحث عن الصلاحيات...",
        "keep_file": "الاحتفاظ بهذا الملف",
        "groups": "مجموعات",
        "pairs": "أزواج",
        "data_import_duplicates_counts": "اقتراحات",
        "db_dup_merge_confirm": "دمج هذين الملفين؟ سيتم حذف الملف المصدر.",
        "db_dup_merge_ok": "تم الدمج بنجاح.",
        "db_dup_merge_failed": "فشل الدمج.",
        "dup_phone_differs": "الهاتف مختلف",
        "dup_page_differs": "رقم الصفحة مختلف",
        "dup_missing_phone": "هاتف مفقود",
        "dup_missing_file": "رقم ملف مفقود",
        "dup_missing_page": "رقم صفحة مفقود",
        "dup_merge_into_keep": "دمج في الملف المُحتفَظ به",
        "more": "المزيد",
        "disabled": "معطّل",
        "preview": "معاينة",
        "start": "بدء",
        "upload": "رفع",
        "remove": "إزالة",
        "file_number": "رقم الملف",
        "reset_theme_defaults": "إعادة الافتراضي",
        "colors": "الألوان",
        "branding": "الهوية",
        "pdf_branding": "هوية PDF",
        "primary_color": "اللون الأساسي",
        "accent_color": "لون ثانوي",
        "base_font_size": "حجم الخط",
        "clinic_logo": "شعار العيادة",
        "current_logo": "الشعار الحالي",
        "logo_hint": "PNG أو JPG، الحد الأقصى 2MB.",
        "remove_logo": "إزالة الشعار",
        "past_logos": "شعارات سابقة",
        "use_selected_logo": "استخدام الشعار المحدد",
        "logo_size": "حجم الشعار",
        "logo_size_hint": "يتحكم بحجم الشعار في الشريط العلوي.",
        "clinic_name_label": "اسم العيادة",
        "clinic_name_placeholder": "مثال: ISmile Dental Clinic",
        "clinic_tagline_label": "الشعار",
        "clinic_tagline_placeholder": "مثال: Dental Clinic",
        "show_clinic_name": "إظهار اسم العيادة",
        "show_clinic_tagline": "إظهار الشعار",
        "clinic_brand_color": "لون الهوية",
        "clinic_brand_hint": "يستخدم لاسم العيادة والشعار.",
        "current_pdf_logo": "شعار PDF الحالي",
        "theme_preview_hint": "تتحدث المعاينة بعد الحفظ.",
        "no_logo": "لا يوجد شعار",
        "range_name": "اسم النطاق",
        "patients_tab": "المرضى",
        "any_doctor": "أي طبيب",
        "no_images_yet": "لا توجد صور بعد",
        "exam_bonus_hint": "زيارة الاستشارة لا تضيف مبلغًا تلقائيًا.",
        "diag_adult": "بالغ",
        "diag_child": "طفل",
        "diag_adult_range": "بالغ 1–8",
        "diag_child_range": "طفل A–E",
        "patient_fallback_name": "المريض",
        "patient_id_label": "المعرّف",
        "patient_since": "منذ",
        "quick_pick": "اختيار سريع",
        "diag_status_clear": "فارغ",
        "diag_status_healthy": "سليم",
        "diag_status_caries": "تسوس",
        "diag_status_filled": "محشو",
        "diag_status_missing": "مفقود",
        "diag_status_rct": "علاج عصب",
        "diag_status_crown": "تاج",
        "diag_status_implant": "زرعة",
        "diag_status_note": "ملاحظة",
        "tooth_label": "سن",
        "status_label": "الحالة",
        "notes_optional": "ملاحظات اختيارية...",
        "operation_failed": "فشل",
        "saved": "تم الحفظ",
        "saving": "جاري الحفظ...",
        "delete_selected": "حذف المحدد",
        "images_drop_hint": "أسقط الصور هنا أو استخدم الاستيراد",
        "rename": "إعادة تسمية",
        "image": "صورة",
        "prev": "السابق",
        "next": "التالي",
        "page": "صفحة",
        "showing": "عرض",
        "go": "اذهب",
        "no_files": "لا توجد ملفات",
        "upload_failed": "فشل الرفع",
        "duplicates_skipped": "تم تخطي المكررات",
        "uploaded_with_skip": "تم الرفع {saved} • تم التجاهل {skipped}",
        "uploaded_count": "تم الرفع {count}",
        "no_images_selected": "لا توجد صور محددة",
        "delete_selected_confirm": "حذف الصور المحددة؟",
        "delete_failed": "فشل الحذف",
        "rename_failed": "فشل تغيير الاسم",
        "renamed_ok": "تم تغيير الاسم",
        "deleted_ok": "تم الحذف",
        "new_name_prompt": "اسم جديد (احتفظ بالامتداد):",
        "new_name_placeholder": "اسم جديد.ext",
        "delete_image_confirm": "حذف هذه الصورة؟",
        "medical_page_title": "طبي",
        "allergies_present": "يوجد حساسية",
        "list_allergies": "اذكر الحساسية",
        "risk_flags": "علامات خطورة",
        "anticoagulants": "مضادات التخثر",
        "prophylaxis": "وقاية",
        "uncontrolled_dm": "سكري غير منضبط",
        "pregnancy_flag": "حمل",
        "smoking_vaping": "تدخين/تدخين إلكتروني",
        "bisphosphonates_denosumab": "بيسفوسفونات/دينوسوماب",
        "bleeding_disorder": "اضطراب نزيف",
        "immunosuppression_chemo": "مثبط مناعة/علاج كيميائي",
        "prosthetic_valve": "صمام قلبي صناعي",
        "pacemaker_icd": "جهاز تنظيم/صدمات",
        "latex_allergy": "حساسية لاتكس",
        "medical_notes_label": "ملاحظات طبية",
        "medical_notes_placeholder": "أي شيء يجب أن يراه الطبيب سريعاً",
        "idle": "خامل",
        "delete_selected": "حذف المحدد",
        "images_drop_hint": "أسقط الصور هنا أو استخدم الاستيراد",
        "rename": "إعادة تسمية",
        "image": "صورة",
        "prev": "السابق",
        "next": "التالي",
        "login_bootstrap_hint": "لا يوجد مستخدمون بعد. أدخل اسم مستخدم وكلمة مرور لإنشاء حساب المدير الأول.",
        "clinic_spending": "مصروفات العيادة",
        "expenses_intro": "سجل ما تم شراؤه والمبلغ. نحفظ إجمالي الشهر.",
        "quick_expense_tracking": "تسجيل مصروفات سريع وبسيط",
        "expenses": "المصروفات",
        "expenses_hint": "احتفظ بكل إيصال في مكان واحد. الوصف مع السعر يكفي.",
        "total_this_month": "إجمالي هذا الشهر",
        "running_total": "الإجمالي المتراكم",
        "add_expense": "إضافة مصروف",
        "materials_receipts": "مواد / إيصالات",
        "what_did_you_buy": "ماذا اشتريت؟",
        "expenses_placeholder": "مثال: قفازات، معقم، رسوم توصيل...",
        "this_month": "هذا الشهر",
        "expense": "مصروف",
        "s_suffix": "",
        "view_details": "عرض التفاصيل",
        "no_expenses": "لا توجد مصروفات لـ",
        "yet": "حتى الآن.",
        "expense_details": "تفاصيل المصروف",
        "close": "إغلاق",
        "no_description": "لا يوجد وصف.",
        "delete_expense_confirm": "حذف هذا المصروف؟",
        "simple_expenses_title": "مصروفات بسيطة",
        "back_to_dashboard": "العودة للوحة التحكم",
        "delete": "حذف",
        "expenses_management_title": "إدارة المصروفات",
        "expenses_new_receipt": "إيصال مصروف جديد",
        "expenses_enter_total": "يرجى إدخال المبلغ المدفوع.",
        "expenses_searching": "جاري البحث...",
        "expenses_receipts_title": "إيصالات المصروفات",
        "expenses_this_month": "هذا الشهر",
        "expenses_materials_spending": "مصروف المواد",
        "search_filter": "بحث وتصفية",
        "start_date": "تاريخ البدء",
        "end_date": "تاريخ الانتهاء",
        "search_description": "ابحث في الوصف...",
        "category": "الفئة",
        "clear_filters": "مسح الفلاتر",
        "export_csv": "تصدير CSV",
        "export_pdf": "تصدير PDF",
        "expenses_receipts": "إيصالات المصروفات",
        "new_receipt": "إيصال جديد",
        "description": "الوصف",
        "files": "الملفات",
        "materials_purchase": "شراء مواد",
        "uncategorized": "غير مصنف",
        "pending": "معلق",
        "update_status": "تحديث الحالة",
        "no_expense_receipts": "لا توجد إيصالات مصروفات",
        "create_first_expense_receipt": "أنشئ أول إيصال مصروفات للبدء.",
        "create_first_receipt": "إنشاء أول إيصال",
        "expenses_paid_on": "تم دفع {amount} جنيه في {date}",
        "expenses_ref": "مرجع",
        "receipt_details": "تفاصيل الإيصال",
        "items_count": "عدد العناصر",
        "items": "عناصر",
        "financial_summary": "الملخص المالي",
        "collections_total": "إجمالي التحصيل",
        "total_amount": "المبلغ الإجمالي",
        "receipt_items": "عناصر الإيصال",
        "material_name": "اسم المادة",
        "quantity": "الكمية",
        "unit_price": "سعر الوحدة",
        "total_price": "السعر الإجمالي",
        "no_items_in_receipt": "لا توجد عناصر في هذا الإيصال.",
        "what_you_bought": "ما الذي اشتريته",
        "created": "تم الإنشاء",
        "receipt_id": "معرّف الإيصال",
        "new_expense": "مصروف جديد",
        "log_materials_spending": "سجل مصروف المواد",
        "new_expense_hint": "التاريخ، المبلغ المدفوع، ووصف قصير. بدون موردين أو إضافات.",
        "paid_hint": "كم دفعت لهذه المواد.",
        "list_everything": "اكتب كل ما اشتريته...",
        "edit_expense_receipt": "تعديل إيصال مصروف",
        "edit_expense": "تعديل مصروف",
        "edit_expense_hint": "عدّل التاريخ أو المبلغ المدفوع أو الوصف.",
        "save_changes": "حفظ التغييرات",
        "delete_receipt": "حذف الإيصال",
        "approval_notes_placeholder": "أضف ملاحظات موافقة أو سبب الرفض أو تعليقات أخرى...",
        "approval_notes_help": "ملاحظات اختيارية حول تغيير الحالة أو الموافقة.",
        "status_history": "سجل الحالة",
        "receipt_label": "الإيصال",
        "supplier": "المورد",
        "expense_categories": "فئات المصروفات",
        "expense_categories_intro": "نظم إيصالات المصروفات حسب الفئة لتحسين التتبع والتقارير.",
        "new_category": "فئة جديدة",
        "no_categories_yet": "لا توجد فئات بعد",
        "create_first_category_hint": "أنشئ أول فئة مصروفات لبدء التنظيم.",
        "create_first_category": "إنشاء أول فئة",
        "materials": "المواد",
        "unit": "الوحدة",
        "price_per_unit": "السعر لكل وحدة",
        "active": "نشط",
        "inactive": "غير نشط",
        "new_material": "مادة جديدة",
        "no_materials_found": "لا توجد مواد",
        "create_first_material_hint": "أنشئ أول مادة للبدء.",
        "create_first_material": "إنشاء أول مادة",
        "suppliers": "الموردون",
        "new_supplier": "مورد جديد",
        "contact_person": "الشخص المسؤول",
        "tax_number_short": "الرقم الضريبي:",
        "no_suppliers_found": "لا يوجد موردون",
        "create_first_supplier_hint": "أنشئ أول مورد للبدء.",
        "create_first_supplier": "إنشاء أول مورد",
        "create_new_supplier": "إنشاء مورد جديد",
        "enter_supplier_name": "أدخل اسم المورد",
        "contact_person_name": "اسم الشخص المسؤول",
        "phone_number": "رقم الهاتف",
        "email_address": "عنوان البريد الإلكتروني",
        "physical_address": "العنوان",
        "tax_registration_number": "رقم التسجيل الضريبي",
        "create_new_material": "إنشاء مادة جديدة",
        "enter_material_name": "أدخل اسم المادة",
        "material_category": "فئة المادة",
        "unit_placeholder": "مثال: كجم، قطعة، صندوق",
        "material_description": "وصف المادة",
        "receipt_files_title": "ملفات الإيصال",
        "files_for_receipt": "ملفات الإيصال",
        "back_to_receipt": "العودة للإيصال",
        "add_files": "إضافة ملفات",
        "attached_files": "الملفات المرفقة",
        "pdf_document": "ملف PDF",
        "file_label": "ملف",
        "download": "تحميل",
        "no_files_attached": "لا توجد ملفات مرفقة",
        "upload_receipt_files_hint": "ارفع ملفات الإيصال للاحتفاظ بنسخ رقمية.",
        "upload_first_file": "ارفع أول ملف",
        "upload_receipt_files": "رفع ملفات الإيصال",
        "image_preview": "معاينة الصورة",
        "delete_file_confirm": "حذف هذا الملف؟",
        "delete_failed_unknown": "فشل حذف الملف",
        "expense_receipt_label": "إيصال مصروف",
        "approved_on": "تمت الموافقة في",
        "by_user": "بواسطة",
        "approval_notes": "ملاحظات الموافقة",
        "supplier_information": "معلومات المورد",
        "financial_details": "التفاصيل المالية",
        "subtotal": "الإجمالي الفرعي",
        "tax_amount": "قيمة الضريبة",
        "item_description": "وصف البند",
        "add_file": "إضافة ملف",
        "attach_files": "إرفاق ملفات",
        "file_preview": "معاينة الملف",
        "theme_save_failed": "فشل حفظ السمة",
        "theme_saved_reload": "تم حفظ السمة. أعد التحميل للتطبيق.",
        "theme_unexpected_error": "حدث خطأ غير متوقع أثناء حفظ السمة.",
        "theme_presets": "قوالب ألوان",
        "theme_preset_calm": "أزرق هادئ",
        "theme_preset_warm": "ذهبي دافئ",
        "theme_preset_mint": "أخضر ناعم",
        "theme_pick_from_logo": "استخدام ألوان الشعار",
        "admin_user_load_error": "خطأ في تحميل بيانات المستخدم",
        "admin_generic_error": "حدث خطأ. يرجى المحاولة مرة أخرى.",
        "admin_user_delete_confirm": "هل أنت متأكد من حذف المستخدم \"{name}\"؟",
        "admin_error_prefix": "خطأ:",
        "admin_role_load_error": "خطأ في تحميل بيانات الدور",
        "admin_role_delete_confirm": "هل أنت متأكد من حذف الدور \"{name}\"؟",
        "admin_role": "الدور",
        "admin_permissions": "الصلاحيات",
        "admin_more": "المزيد",
        "admin_doctor_save_failed": "فشل حفظ الطبيب",
        "admin_doctor_save_unexpected": "خطأ غير متوقع أثناء حفظ الطبيب.",
        "admin_doctor_delete_error": "خطأ في حذف الطبيب",
        "admin_doctor_deleted": "تم حذف الطبيب.",
        "admin_doctor_delete_confirm": "حذف الطبيب \"{name}\"؟",
        "admin_doctor_delete_confirm_simple": "حذف هذا الطبيب؟",
        "admin_reset_colors_confirm": "هل أنت متأكد من إعادة تعيين ألوان الأطباء للوضع الافتراضي؟",
        "admin_unknown_error": "خطأ غير معروف",
        "doctor_name_required": "اسم الطبيب مطلوب.",
        "doctor": "الطبيب",
        "select_doctor": "اختر الطبيب",
        "doctor_required": "يرجى اختيار الطبيب.",
        "please_fix_errors": "يرجى تصحيح هذه الأخطاء:",
        "similar_expenses_found": "تم العثور على مصروفات مشابهة",
        "duplicates_hint": "وجدنا مصروفات قد تكون مكررة. يمكنك:",
        "merge_existing": "دمج مع الموجود",
        "merge_existing_hint": "اختر مصروفاً موجوداً للتحديث بدلاً من إنشاء واحد جديد:",
        "merge_with_selected": "دمج مع المحدد",
        "add_as_new": "إضافة كمصروف جديد",
        "add_new_hint": "احتفظ بهذا كمدخل منفصل:",
        "add_anyway": "إضافة على أي حال",
        "specific_help": "كن محدداً لتسهيل البحث لاحقاً",
        "save_expense": "حفظ المصروف",
        "no_permissions": "لا توجد صلاحيات",
        "add_doctor": "إضافة طبيب",
        "reset_to_defaults": "إعادة الضبط للإعدادات الافتراضية",
        "current_color": "اللون الحالي",
        "deleted_doctors": "الأطباء المحذوفون",
        "last_color": "آخر لون",
        "deleted_at": "تاريخ الحذف",
        "doctor_id": "معرّف الطبيب",
        "generated_automatically": "سيُنشأ تلقائياً",
        "doctor_name": "اسم الطبيب",
        "color": "اللون",
        "theme_preview_title": "معاينة السمة",
        "theme_text_color": "لون النص",
        "theme_text_color_hint": "يُستخدم للون النص الأساسي والعناوين.",
        "theme_btn_text_color": "لون نص الأزرار",
        "theme_btn_text_color_hint": "يُستخدم لنص الأزرار الرئيسية المرتبطة بالثيم والإحصائيات.",
        "theme_metric_color": "لون الأرقام البارزة",
        "theme_metric_color_hint": "يُستخدم للأرقام الكبيرة مثل عدد المرضى والإجماليات.",
        "theme_page_bg_tint": "تدرّج خلفية الصفحة",
        "theme_page_bg_tint_hint": "لون فاتح جداً يُمزج مع خلفية الصفحة العامة.",
        "theme_card_bg_tint": "تدرّج له بطاقات مميّزة",
        "theme_card_bg_tint_hint": "لون لطيف اختياري لبطاقات العناوين فقط. تبقى البطاقات العادية فاتحة.",
        "save_theme": "حفظ السمة",
        "login_bootstrap_hint": "لا يوجد مستخدمون بعد. أدخل اسم مستخدم وكلمة مرور لإنشاء حساب المدير الأول.",
        "clinic_spending": "مصروفات العيادة",
        "expenses_intro": "سجل ما تم شراؤه والمبلغ. نحفظ إجمالي الشهر.",
        "quick_expense_tracking": "تسجيل مصروفات سريع وبسيط",
        "please_fix_errors": "يرجى تصحيح هذه الأخطاء:",
        "similar_expenses_found": "تم العثور على مصروفات مشابهة",
        "duplicates_hint": "وجدنا مصروفات قد تكون مكررة. يمكنك:",
        "merge_existing": "دمج مع الموجود",
        "merge_existing_hint": "اختر مصروفاً موجوداً للتحديث بدلاً من إنشاء واحد جديد:",
        "merge_with_selected": "دمج مع المحدد",
        "add_as_new": "إضافة كمصروف جديد",
        "add_new_hint": "احتفظ بهذا كمدخل منفصل:",
        "add_anyway": "إضافة على أي حال",
        "specific_help": "كن محدداً لتسهيل البحث لاحقاً",
        "save_expense": "حفظ المصروف",
        "method_cash": "نقدًا",
        "method_card": "بطاقة",
        "method_transfer": "تحويل",
        "method_other": "أخرى",
        "appointments": "المواعيد",
        "global_search_placeholder": "بحث عن مريض...",
        "no_results_found": "لا توجد نتائج",
        "searching": "جاري البحث...",
        "appointment": "موعد",
        "new": "جديد",
        "today": "اليوم",
        "yesterday": "الأمس",
        "tomorrow": "غداً",
        "all": "الكل",
        "end": "النهاية",
        "appointments_today": "مواعيد اليوم",
        "appointments_new": "موعد جديد",
        "appointments_filters": "عوامل التصفية",
        "appointments_day_label": "اليوم",
        "appointments_doctor_label": "الطبيب",
        "appointments_doctor_all": "جميع الأطباء",
        "appointments_slot_label": "وقت البدء",
        "appointments_duration_label": "المدة (بالدقائق)",
        "appointments_notes_label": "ملاحظات الزيارة",
        "appointments_patient_lookup": "المريض (رقم الملف أو الاسم)",
        "appointments_patient_name": "اسم المريض (اختياري)",
        "appointments_patient_phone": "رقم الهاتف (اختياري)",
        "appointments_title_label": "عنوان الزيارة",
        "appointments_submit": "حفظ الموعد",
        "appointments_empty_hour": "لا توجد مواعيد في هذه الساعة.",
        "appointments_range_label": "النطاق الزمني",
        "appointments_range_today": "اليوم فقط",
        "appointments_range_next3": "الأيام الثلاثة القادمة",
        "appointments_range_next7": "الأيام السبعة القادمة",
        "appointments_range_all": "كل المواعيد القادمة",
        "appointments_show_label": "عرض",
        "appointments_show_upcoming": "المواعيد القادمة",
        "appointments_show_past": "المواعيد السابقة",
        "appointments_show_all": "جميع المواعيد",
        "appointments_search_label": "بحث",
        "appointments_total_label": "إجمالي المواعيد",
        "appointments_search_placeholder": "ابحث بالاسم أو الهاتف أو رقم الملف",
        "appointments_no_notes": "لا توجد ملاحظات",
        "appointment_conflict": "يوجد موعد آخر في هذا الوقت.",
        "appointment_status_scheduled": "مجدول",
        "appointment_status_checked_in": "تم الوصول",
        "appointment_status_in_progress": "قيد التقديم",
        "appointment_status_done": "منتهي",
        "appointment_status_no_show": "لم يحضر",
        "appointment_status_cancelled": "ملغى",
        "appointments_more_chip": "+{count} مواعيد إضافية",
        "appointment_edit_title": "تعديل موعد",
        "appointment_update_btn": "تحديث الموعد",
        "appointment_deleted": "تم حذف الموعد",
        "appointment_delete_failed": "فشل حذف الموعد.",
        "appointments_found_count": "تم العثور على {count} موعد",
        "appointments_show_all_count": "عرض كل {count} موعد",
        "appointments_generic_error": "حدث خطأ",
        "receivables": "الأرصدة المستحقة",
        "receivables_total": "إجمالي المستحق على العيادة",
        "receivables_patients": "عدد المرضى الذين عليهم رصيد",
        "appointment_delete_title": "حذف الموعد",
        "appointment_delete_working": "جاري الحذف...",
        "appointments_search_error": "خطأ في البحث عن المرضى",
        "appointment_loading": "جاري التحميل...",
        "appointment_patient_label": "المريض",
        "appointment_patient_placeholder": "اكتب اسم المريض أو رقم الملف أو الهاتف...",
        "appointment_doctor_label": "الطبيب",
        "appointment_choose_doctor": "اختر الطبيب",
        "appointment_status_label": "الحالة",
        "appointment_date_label": "التاريخ",
        "appointment_start_time_label": "وقت البدء",
        "appointment_start_time_placeholder": "حدد الوقت",
        "appointment_title_label": "العنوان",
        "appointment_title_placeholder": "مثال: فحص، حشوة...",
        "appointment_time_label": "الوقت",
        "appointment_view_title": "عرض الموعد",
        "appointment_delete_confirm": "هل أنت متأكد من حذف موعد",
        "appointment_delete_warning": "هذا الإجراء لا يمكن التراجع عنه.",
        "change_status": "تغيير الحالة",
        "appointment_save_failed": "فشل حفظ الموعد.",
        "appointment_updated": "تم تحديث الموعد",
        "appointment_added": "تم إضافة الموعد",
        "unknown_patient": "مريض غير معروف",
        "no_reason_provided": "لا يوجد سبب محدد",
        "appointment_start_time_required": "وقت البدء مطلوب",
        "appointments_end_date": "نهاية التاريخ",
        "edit": "تعديل",
        "admin_settings": "إعدادات المدير",
        "admin_settings_intro": "إدارة المستخدمين والأدوار والصلاحيات والأطباء المضافين",
        "data_import": "استيراد البيانات",
        "data_import_intro": "استيراد بيانات العيادة من ملف بطريقة آمنة على خطوتين.",
        "data_import_first_stable_hint": "يفضل استخدام قالب CSV للحصول على أفضل نتيجة. يمكنك أيضًا رفع ملف إكسل إذا كان مطابقًا لأعمدة القالب.",
        "data_import_preview_btn": "تحليل الملف (بدون تعديل)",
        "data_import_summary": "معاينة الصفوف",
        "data_import_preview_only_note": "هذه الخطوة لا تغيّر قاعدة البيانات. بعد مراجعة المعاينة استخدم زر الاستيراد لإضافة البيانات إلى قاعدة بيانات العيادة.",
        "data_import_download_template": "تحميل قالب CSV",
        "data_import_commit_title": "استيراد إلى قاعدة بيانات العيادة",
        "data_import_commit_help": "سيتم إضافة المرضى والمدفوعات إلى قاعدة بيانات العيادة الحقيقية. سيتم إنشاء نسخة احتياطية تلقائياً أولاً.",
        "data_import_skip_duplicates": "تجاهل الصفوف المستوردة مسبقاً (موصى به)",
        "data_import_import_zero_entries": "استيراد سجلات بدون مبلغ (سجل الزيارات)",
        "data_import_commit_btn": "استيراد إلى العيادة (يُعدّل قاعدة البيانات)",
        "data_import_download_report": "تحميل تقرير الاستيراد",
        "data_import_loading": "جاري تحليل الملف...",
        "data_import_preview_failed": "تعذر قراءة الملف.",
        "data_import_preview_ok": "تم إنشاء المعاينة.",
        "data_import_no_rows": "لم يتم العثور على صفوف صالحة في الملف.",
        "data_import_total_rows": "الصفوف",
        "data_import_patients": "المرضى",
        "data_import_payments": "المدفوعات",
        "data_import_zero_entries": "سجلات بدون مبلغ",
        "data_import_zero_entries_in_file": "سجلات بدون مبلغ (في الملف)",
        "data_import_skipped_rows": "صفوف فارغة تم تجاهلها",
        "data_import_missing_file": "عدد الصفوف بدون رقم ملف",
        "data_import_missing_name": "عدد الصفوف بدون اسم",
        "data_import_unexpected": "حدث خطأ غير متوقع أثناء قراءة الملف.",
        "data_import_commit_confirm": "سيتم تعديل قاعدة بيانات العيادة وقد يستغرق ذلك دقيقة. سيتم إنشاء نسخة احتياطية أولاً. هل تريد المتابعة؟",
        "data_import_commit_running": "جاري الاستيراد... من فضلك انتظر.",
        "data_import_commit_ok": "تم الاستيراد بنجاح.",
        "data_import_commit_failed": "فشل الاستيراد.",
        "data_import_preflight_btn": "فحص الاستيراد (بدون تعديل)",
        "data_import_preflight_running": "جاري فحص الاستيراد مقابل قاعدة البيانات...",
        "data_import_preflight_ok": "تم فحص الاستيراد.",
        "data_import_preflight_failed": "فشل فحص الاستيراد.",
        "data_import_new_patients": "مرضى جدد",
        "data_import_new_payments": "مدفوعات جديدة",
        "data_import_unknown_dates": "تواريخ غير معروفة (تركت فارغة)",
        "audit_tab_title": "السجل",
        "audit_payments_title": "سجل المدفوعات",
        "audit_user_hint": "اسم المستخدم",
        "audit_payment_create": "تمت إضافة دفعة",
        "audit_payment_update": "تم تعديل الدفعة",
        "audit_payment_delete": "تم حذف الدفعة",
        "audit_load_failed": "تعذر تحميل السجل.",
        "audit_privacy_title": "خصوصية السجل",
        "audit_snapshots_title": "لقطات المريض",
        "audit_snapshots_enabled": "حفظ لقطة للمريض (الاسم + رقم الملف/الصفحة)",
        "audit_snapshots_retention": "الاحتفاظ باللقطات لمدة",
        "audit_snapshots_help": "تُبقي اللقطات السجل مقروءًا حتى بعد حذف ملف المريض. يمكنك حذف اللقطات في أي وقت؛ أحداث السجل تبقى.",
        "audit_snapshots_help_deleted": "المرضى الذين تم حذفهم سابقًا لا يمكن استرجاعهم وسيظهرون كـ “مريض غير معروف”.",
        "audit_privacy_load_failed": "تعذر تحميل إعدادات الخصوصية.",
        "audit_privacy_saved": "تم الحفظ.",
        "audit_privacy_save_failed": "فشل الحفظ.",
        "audit_snapshots_table_missing": "جدول اللقطات غير موجود. شغّل Run-Migrations.bat.",
        "audit_snapshots_count": "اللقطات المحفوظة",
        "audit_snapshots_backfill": "تعبئة سابقة",
        "audit_snapshots_purge_expired": "حذف المنتهي",
        "audit_snapshots_purge_all": "حذف الكل",
        "audit_snapshots_backfill_running": "جارٍ التعبئة...",
        "audit_snapshots_backfill_ok": "اكتملت التعبئة.",
        "audit_snapshots_backfill_failed": "فشلت التعبئة.",
        "audit_snapshots_purge_running": "جارٍ الحذف...",
        "audit_snapshots_purge_ok": "تم حذف اللقطات.",
        "audit_snapshots_purge_failed": "فشل الحذف.",
        "audit_snapshots_purge_all_confirm": "حذف كل اللقطات المحفوظة؟ أحداث السجل ستبقى.",
        "audit_snapshots_view": "عرض اللقطات",
        "audit_snapshots_load_failed": "تعذر تحميل اللقطات.",
        "audit_view_title": "سجل العملية",
        "audit_prev_not_recorded": "(القيمة السابقة غير مسجلة)",
        "changes": "التغييرات",
        "before": "قبل",
        "after": "بعد",
        "current": "الحالي",
        "technical_details": "تفاصيل تقنية",
        "audit_confirm_backfill_title": "تعبئة اللقطات",
        "audit_confirm_backfill_msg": "سيتم إنشاء لقطات لأحداث قديمة حيث ما زال ملف المريض موجودًا. هل تريد المتابعة؟",
        "audit_confirm_purge_expired_title": "حذف اللقطات المنتهية",
        "audit_confirm_purge_expired_msg": "سيتم حذف اللقطات الأقدم من مدة الاحتفاظ. أحداث السجل ستبقى. هل تريد المتابعة؟",
        "audit_confirm_purge_all_title": "حذف كل اللقطات",
        "audit_confirm_purge_all_msg": "سيتم حذف كل اللقطات المحفوظة. أحداث السجل ستبقى. هل تريد المتابعة؟",
        "audit_confirm_purge_all_ok": "حذف الكل",
        "name_or_file": "اسم / ملف / صفحة",
        "details": "تفاصيل",
        "data_analyze_mode_label": "وضع التحليل",
        "data_analyze_mode_safe": "آمن",
        "data_analyze_mode_normal": "عادي",
        "data_analyze_mode_aggressive": "متشدد",
        "data_analyze_mode_tip": "آمن: رقم صفحة + الاسم الكامل (الهاتف عند وجوده). عادي: رقم صفحة + الاسم الكامل (الهاتف اختياري). متشدد: الاسم فقط.",
        "summary": "الملخص",
        "warnings": "تنبيهات",
        "options": "الخيارات",
        "mode": "الوضع",
        "data_import_skip_duplicates_short": "تم تجاهل المكرر",
        "data_import_skip_edited_rows_short": "تم تجاهل الصفوف القديمة المعدلة",
        "duplicate_phone_in_file": "رقم الهاتف مكرر داخل ملف نفس المريض. رجاءً اكتب كل رقم مرة واحدة فقط.",
        "data_import_opt_skip_duplicates": "تجاهل المكرر",
        "data_import_opt_import_zero_entries": "استيراد سجلات بدون مبلغ",
        "data_import_opt_safe_merge": "دمج آمن",
        "data_import_page_conflicts": "تعارض رقم الصفحة",
        "data_import_commit_only_main_db": "ميزة الاستيراد غير متاحة في وضع المعاينة. من فضلك شغّل البرنامج العادي (Start-Clinic.bat) للاستيراد إلى قاعدة البيانات الحقيقية.",
        "data_import_backup_failed": "تعذر إنشاء نسخة احتياطية لقاعدة البيانات",
        "data_import_schema_missing": "قاعدة بيانات العيادة لا تحتوي على حقول المدفوعات المطلوبة ({cols}). من فضلك شغّل Run-Migrations.bat ثم حاول مرة أخرى.",
        "data_import_db_duplicates_title": "احتمال تكرار في قاعدة البيانات",
        "data_import_db_duplicates_hint": "يقوم هذا بفحص قاعدة بيانات العيادة الحالية لوجود تكرار محتمل. لن يتم دمج أي شيء تلقائياً.",
        "data_import_db_duplicates_scan_simple_btn": "فحص التكرارات",
        "data_import_db_duplicates_safe_btn": "فحص (آمن)",
        "data_import_db_duplicates_normal_btn": "فحص (عادي)",
        "data_import_db_duplicates_aggressive_btn": "فحص (متشدد)",
        "data_import_db_duplicates_idle": "اضغط فحص لرؤية التكرارات المحتملة.",
        "data_import_db_duplicates_loading": "جاري فحص قاعدة البيانات...",
        "data_import_db_duplicates_none": "لا يوجد تكرار.",
        "data_import_db_duplicates_mode_safe": "وضع آمن: الاسم + نفس/بدون رقم هاتف.",
        "data_import_db_duplicates_mode_normal": "وضع عادي: الاسم + نفس الهاتف/الصفحة (أو هاتف مفقود).",
        "data_import_db_duplicates_mode_aggressive": "وضع متشدد: الاسم فقط.",
        "data_db_duplicates_mode_tip": "آمن: الاسم + نفس/بدون هاتف. عادي: الاسم + نفس الهاتف/الصفحة. متشدد: الاسم فقط.",
        "dup_reason_same_phone": "نفس الهاتف",
        "dup_reason_same_page": "نفس الصفحة",
        "dup_reason_name_only": "اسم فقط",
        "data_import_report_dups_normal_btn": "مراجعة التكرارات (عادي)",
        "data_tab_simple": "بسيط",
        "data_tab_advanced": "متقدم",
        "data_tab_mode_hint": "استخدم المتقدم عند الحاجة فقط.",
        "data_tab_title": "البيانات",
        "data_sub_import": "استيراد",
        "data_sub_analyze": "تحليل",
        "data_sub_duplicates": "تكرارات",
        "data_sub_export": "تصدير",
        "data_sub_reports": "تقارير",
        "data_sub_backups": "نسخ احتياطي",
        "data_file_title": "الملف المختار",
        "data_file_none": "لم يتم اختيار ملف.",
        "data_file_clear": "مسح",
        "data_step_1": "الخطوة 1",
        "data_step_2": "الخطوة 2",
        "data_step_3": "الخطوة 3",
        "data_import_search_hint": "ابحث بالاسم أو الهاتف أو رقم الملف أو رقم الصفحة",
        "db_backups_title": "نسخ احتياطية لقاعدة البيانات",
        "db_backups_hint": "يتم إنشاء نسخة احتياطية تلقائياً قبل كل استيراد. يمكنك أيضاً إنشاء نسخة يدوياً هنا.",
        "db_backups_loading": "جاري تحميل النسخ الاحتياطية...",
        "db_backups_load_failed": "تعذر تحميل النسخ الاحتياطية.",
        "db_backups_empty": "لا توجد نسخ احتياطية بعد.",
        "db_backup_create_now": "إنشاء نسخة احتياطية الآن",
        "db_backup_created": "تم إنشاء النسخة الاحتياطية.",
        "db_backup_failed": "فشل إنشاء النسخة الاحتياطية.",
        "db_backups_restore_note": "الاستعادة أكثر أماناً عندما يكون البرنامج مغلقاً. إذا احتجت للاستعادة قل لي وسأضيف خطوات استعادة موجهة.",
        "db_backup_restore_confirm": "هل تريد استعادة هذه النسخة؟ سيتم إغلاق البرنامج ثم افتحه باستخدام Start-Clinic.bat.",
        "db_backup_restore_running": "جاري الاستعادة... سيتم إغلاق البرنامج الآن.",
        "db_backup_restore_ok": "تمت جدولة الاستعادة. من فضلك أعد فتح البرنامج.",
        "db_backup_restore_failed": "فشلت الاستعادة.",
        "db_backup_restore_scheduled": "تمت جدولة الاستعادة. سيتم إغلاق البرنامج الآن. افتحه باستخدام Start-Clinic.bat.",
        "db_backup_invalid": "ملف النسخة الاحتياطية غير صالح.",
        "db_backup_not_found": "لم يتم العثور على النسخة الاحتياطية.",
        "data_import_page_conflicts": "تعارض رقم الصفحة",
        "open": "فتح",
        "download": "تحميل",
        "refresh": "تحديث",
        "file": "ملف",
        "size": "الحجم",
        "data_import_file_not_found": "لم يتم العثور على الملف.",
        "data_import_view_payments": "عرض المدفوعات",
        "data_import_status_done": "مغلق",
        "data_import_status_owing": "مستحق",
        "loading": "جارٍ التحميل...",
        "font_clamp_hint": "محصورة بين 14-18 بكسل لحماية التصميم.",
        "admin_deleted_doctors_empty": "لا يوجد أطباء محذوفون.",
        "admin_restore": "استعادة",
        "admin_delete_permanent": "حذف نهائي",
        "medical": "طبي",
        "receipts": "الإيصالات",
        "receipts_new": "إصدار إيصال",
        "receipts_recent": "آخر الإيصالات",
        "receipts_patient_placeholder": "رقم الملف أو الاسم",
        "receipt_lookup_hint": "P000123",
        "receipts_description_placeholder": "الوصف الظاهر في الإيصال",
        "receipts_amount": "المبلغ",
        "receipts_locale": "اللغة",
        "receipts_pdf": "تحميل PDF",
        "receipts_reprint": "إعادة الطباعة",
        "receipts_success": "تم إصدار الإيصال",
        "receipts_reprint_done": "تم تسجيل إعادة الطباعة",
        "receipt_heading": "إيصال العيادة",
        "receipt_number_label": "رقم الإيصال",
        "receipt_date_label": "التاريخ",
        "receipt_patient_label": "المريض",
        "receipt_phone_label": "الهاتف",
        "receipt_description_label": "الوصف",
        "receipt_amount_label": "المبلغ",
        "receipt_qr_hint": "رمز الاستجابة",
        "receipt_default_desc": "خدمات الأسنان",
        "appointments_table_missing": "يرجى تشغيل `flask db upgrade` لتفعيل جدول المواعيد.",
        "receipts_table_missing": "يرجى تشغيل `flask db upgrade` لتفعيل الإيصالات.",
        "amount_required": "يرجى إدخال مبلغ صالح",
        "patient_not_found": "المريض غير موجود",
        "receipt_not_found": "الإيصال غير موجود",
        "title_required": "العنوان مطلوب",
        "invalid_status": "حالة غير صحيحة",
        "invalid_datetime": "تاريخ أو وقت غير صحيح",
        "roles_manage_title": "الأدوار والصلاحيات",
        "roles_new_button": "دور جديد",
        "roles_edit_heading": "تعديل الدور",
        "role_form_name": "اسم الدور",
        "role_form_description": "الوصف",
        "role_form_permissions": "الصلاحيات",
        "role_permissions_hint": "اختر الصلاحيات المسموح بها لهذا الدور.",
        "role_created": "تم إنشاء الدور",
        "role_updated": "تم تحديث الدور",
        "role_exists": "اسم الدور موجود بالفعل.",
        "role_name_required": "يجب أن يحتوي اسم الدور على حرفين على الأقل.",
        "role_not_found": "لم يتم العثور على الدور",
        # Print Receipt Features
        "print_receipt": "طباعة الإيصال",
        "print_receipt_title": "طباعة إيصال الدفع",
        "print_scope": "نطاق الطباعة",
        "payment_only": "الدفع فقط",
        "payment_snapshot": "إيصال الدفع + ملخص العلاج",
        "payment_summary": "ملخص الدفع",
        "view_receipt": "عرض الإيصال",
        "receipt_format": "تنسيق الإيصال",
        "format_full": "كامل",
        "format_summary": "ملخص",
        "format_treatment": "علاج",
        "format_payment": "دفع فقط",
        "preview_receipt": "معاينة الإيصال",
        "print_confirmation": "هل تريد طباعة الإيصال؟",
        "receipt_generation_error": "خطأ في إنشاء الإيصال: {error}",
        "receipt_downloaded": "تم تحميل الإيصال بنجاح",
        "print_loading": "جاري إنشاء الإيصال...",
        "print_success": "تم طباعة الإيصال بنجاح",
        "print_error": "فشل في إنشاء الإيصال. حاول مرة أخرى.",
        "include_qr": "تضمين رمز الاستجابة",
        "include_notes": "ملاحظات العلاج",
        "include_payment_notes": "ملاحظات الدفع",
        "treatment_notes": "ملاحظات العلاج",
        "payment_notes": "ملاحظات الدفع",
        "include_treatment": "تضمين تفاصيل العلاج",
        "add_watermark": "إضافة علامة مائية للنسخة",
        "download_pdf": "تحميل PDF",
        # PDF specific keys
        "patient_name": "اسم المريض",
        "file_no": "رقم الملف",
        "payment_date": "تاريخ الدفع",
        "payment_method": "طريقة الدفع",
        "total_amount": "إجمالي المبلغ",
        "discount": "الخصم",
        "paid_amount": "المبلغ المدفوع",
        "remaining_balance": "الرصيد المتبقي",
        "treatment": "العلاج",
        "patient": "المريض",
        "date": "التاريخ",
        "amount_paid": "المبلغ المدفوع",
        "method": "الطريقة",
        "treatment_date": "تاريخ العلاج",
        "total_cost": "التكلفة الإجمالية",
        "amount": "المبلغ",
        "reference": "المرجع",
        "paid": "مدفوع",
        "receipt_id_label": "رقم الإيصال: {receipt_id}",
        "generated_label": "تاريخ الطباعة: {current_time}",
        "thank_you_message": "شكرا لاختيار عيادتنا!",
        # Copy watermark feature
        "copy_watermark": "نسخة العيادة",
        "copy_watermark_description": "يميز الإيصالات كنسخ داخلية للاستخدام في العيادة",
    },
}


def _normalize_locale(value: str | None) -> str | None:
    if not value:
        return None
    value = value.lower()
    return value if value in SUPPORTED_LOCALES else None


def resolve_locale(req=None, app=None) -> str:
    try:
        app = app or current_app  # type: ignore[assignment]
    except RuntimeError:
        app = None

    cookie_name = "lang"
    config_default = None
    if app is not None:
        cookie_name = app.config.get("LOCALE_COOKIE_NAME", cookie_name)
        config_default = _normalize_locale(app.config.get("DEFAULT_LOCALE"))

    if req is None and has_request_context():
        req = request

    if req is not None:
        cookie_lang = _normalize_locale(req.cookies.get(cookie_name))
        if cookie_lang:
            return cookie_lang
        query_lang = _normalize_locale(req.args.get("lang"))
        if query_lang:
            return query_lang

    if config_default:
        return config_default
    return FALLBACK_LOCALE


def get_lang() -> str:
    return resolve_locale()


def T(key: str, **fmt) -> str:
    lang = get_lang()
    text = I18N.get(lang, I18N["en"]).get(key, key)
    return text.format(**fmt) if fmt else text


def dir_attr(lang: str | None = None) -> str:
    if lang is None:
        lang = get_lang()
    return "rtl" if lang == "ar" else "ltr"


def translate_text(locale: str, key: str, **fmt) -> str:
    lang = locale if locale in SUPPORTED_LOCALES else FALLBACK_LOCALE
    text = I18N.get(lang, I18N["en"]).get(key, key)
    return text.format(**fmt) if fmt else text


def register_jinja(app) -> None:
    app.jinja_env.globals.setdefault("T", T)
    app.jinja_env.globals.setdefault("t", T)
    app.jinja_env.globals.setdefault("dir_attr", dir_attr)
