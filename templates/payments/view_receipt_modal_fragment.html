<div class="receipt-modal-host">
  <div class="receipt-view-panel">
    <div class="receipt-view-summary">
      {% set visit_type = 'none' %}
      {% if (raw_payment.get('examination_flag') or 0) == 1 %}
        {% set visit_type = 'exam' %}
      {% elif (raw_payment.get('followup_flag') or 0) == 1 %}
        {% set visit_type = 'followup' %}
      {% endif %}
      {% set visit_label = t('vt_exam') if visit_type == 'exam' else (t('vt_follow') if visit_type == 'followup' else t('vt_none')) %}
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('down_payment') }}</div>
        <div class="summary-value">{{ receipt['paid'] }}</div>
      </div>
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('date') }}</div>
        <div class="summary-value">{{ receipt['date'] }}</div>
      </div>
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('payment_method') }}</div>
        <div class="summary-value">{{ receipt['method'] or '‚Äî' }}</div>
      </div>
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('visit_type') }}</div>
        <div class="summary-value">{{ visit_label }}</div>
      </div>
      {% if raw_payment.get('doctor_label') %}
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('doctor') }}</div>
        <div class="summary-value">{{ raw_payment.get('doctor_label') }}</div>
      </div>
      {% endif %}
      <div class="receipt-view-summary-item">
        <div class="summary-label">{{ t('summary_remaining') }}</div>
        <div class="summary-value">{{ receipt['remaining'] }}</div>
      </div>
    </div>

    <div class="receipt-view-group">
      <div class="receipt-view-section-title">{{ t('receipt_patient_label') }}</div>
      <div class="receipt-patient-header">
        <div class="receipt-patient-name">{{ patient['name'] or '‚Äî' }}</div>
        <div class="receipt-patient-details">
          <span>üìÅ {{ patient['file_no'] or '‚Äî' }}</span>
          <span>üìû {{ patient['phone'] or '‚Äî' }}</span>
        </div>
      </div>
    </div>

    <div class="receipt-view-group">
      <div class="receipt-view-section-title">{{ t('payments') }}</div>
      <div class="receipt-view-row">
        <span class="receipt-view-label">{{ t('summary_total') }}</span>
        <span class="receipt-view-value">{{ receipt['total'] }}</span>
      </div>
      <div class="receipt-view-row">
        <span class="receipt-view-label">{{ t('summary_discount') }}</span>
        <span class="receipt-view-value">{{ receipt['discount'] }}</span>
      </div>
      <div class="receipt-view-row">
        <span class="receipt-view-label">{{ t('summary_paid') }}</span>
        <span class="receipt-view-value">{{ receipt['paid'] }}</span>
      </div>
      <div class="receipt-view-row">
        <span class="receipt-view-label">{{ t('summary_remaining') }}</span>
        <span class="receipt-view-value">{{ receipt['remaining'] }}</span>
      </div>
    </div>

    {% if receipt['treatment'] %}
    <div class="receipt-view-group">
      <div class="receipt-view-section-title">{{ t('treatment') }}</div>
      <p class="receipt-view-note" data-section="treatment">{{ receipt['treatment'] }}</p>
    </div>
    {% endif %}

    {% if receipt['notes'] %}
    <div class="receipt-view-group">
      <div class="receipt-view-section-title">{{ t('sheet_notes') }}</div>
      <p class="receipt-view-note" data-section="notes">{{ receipt['notes'] }}</p>
    </div>
    {% endif %}
  </div>
</div>
